0~~~~                            ~~ Monitor: 5b5e71ba-4948-4775-ab02-7a99ccb4a7c3
   2018-04-13 08h41.46.1268123 i Topic: CK.Monitoring.DispatcherSink
                   +00.0285321   > Initializing TextFile handler (MaxCountPerFile = 20000).
                   +00.0363080   < 
1~~~~                            ~~ Monitor: 81993067-7faf-4bd2-a291-97f8637a90c6
                   +00.1096085 i Folder 'C:\Dev\CK-Database-Projects\CK-DB\Tests\CK.DB.Acl.AclType.Tests\TestStores' has been cleaned up.
                   +00.1855772 i > Accessing null StObj map: invoking StObjMapLoading event.
                   +00.1873309 i | File 'C:\Dev\CK-Database-Projects\CK-DB\Tests\CK.DB.Acl.AclType.Tests\bin\Debug\netcoreapp2.0\CK.StObj.AutoAssembly.dll' does not exist. Running StObjSetup to create it.
                   +00.2048953 i | > Running StObjSetup.
                   +00.2428959 i | | Using default connection string: Server=.;Database=master;Integrated Security=SSPI
                   +03.1429008 i | | > Ensuring database 'Database:CKTEST_CK_DB_Acl_AclType, Collation:Latin1_General_100_BIN2, CompatibilityLevel:130'.
                   +03.3671548 i | | <  | 1 conclusion:
                                 | |    | Database already exists, collation and compatiblity level match.
                   +03.4069511 i | | Using 'CKSetup/DefaultBinPaths' = C:\Dev\CK-Database-Projects\CK-DB\Tests\{CKSetupAutoTargetProjectBinFolder}
                   +03.4261857 i | | BinPath 'C:\Dev\CK-Database-Projects\CK-DB\Tests\{CKSetupAutoTargetProjectBinFolder}' resolved to: C:\Dev\CK-Database-Projects\CK-DB\CK.DB.Acl.AclType\bin\Debug\netstandard2.0.
                   +03.4285875 i | | Using store 'C:\Users\olivi\AppData\Local\CKSetupStore'.
                   +03.4289020 i | | Using remote 'https://cksetup.invenietis.net/'.
                   +03.6148288   | | Opened store with 97 components.
                   +03.6151233   | | Local store opened on : 'C:\Users\olivi\AppData\Local\CKSetupStore'.
                   +03.6170127   | | > Creating client remote store on 'https://cksetup.invenietis.net/'.
                   +03.6518177   | | < 
                   +03.6528213 i | | > Running Setup.
                   +03.6617133   | | | > Initializing SetupContext (ignoring signatures).
                   +03.6679474 i | | | | <Root>
                                 | | | |     <CKSetup>
                                 | | | |       <WorkingDirectory>C:\Dev\CK-Database-Projects\CK-DB\Tests\CK.DB.Acl.AclType.Tests\CKSetup-WorkingDir</WorkingDirectory>
                                 | | | |       <BinPaths>
                                 | | | |         <BinPath>C:\Dev\CK-Database-Projects\CK-DB\CK.DB.Acl.AclType\bin\Debug\netstandard2.0</BinPath>
                                 | | | |       </BinPaths>
                                 | | | |       <Dependencies />
                                 | | | |       <EngineAssemblyQualifiedName>CK.Setup.StObjEngine, CK.StObj.Engine</EngineAssemblyQualifiedName>
                                 | | | |     </CKSetup>
                                 | | | |     <Configuration>
                                 | | | |       <AppContextAssemblyGeneratedDirectoryTarget>C:\Dev\CK-Database-Projects\CK-DB\Tests\CK.DB.Acl.AclType.Tests\bin\Debug\netcoreapp2.0</AppContextAssemblyGeneratedDirectoryTarget>
                                 | | | |       <GenerateSourceFiles>true</GenerateSourceFiles>
                                 | | | |       <Assemblies />
                                 | | | |       <Types />
                                 | | | |       <Aspect Type="CK.Setup.SetupableAspectConfiguration, CK.Setupable.Model" Version="1" />
                                 | | | |       <Aspect Type="CK.Setup.SqlSetupAspectConfiguration, CK.SqlServer.Setup.Model">
                                 | | | |         <Databases />
                                 | | | |         <DefaultDatabaseConnectionString>Data Source=.;Initial Catalog=CKTEST_CK_DB_Acl_AclType;Integrated Security=True</DefaultDatabaseConnectionString>
                                 | | | |         <GlobalResolution>true</GlobalResolution>
                                 | | | |       </Aspect>
                                 | | | |     </Configuration>
                                 | | | |   </Root>
                   +03.6680803 i | | | | Configuration BasePath is empty: using current directory 'C:\Dev\CK-Database-Projects\CK-DB\Tests\CK.DB.Acl.AclType.Tests\bin\Debug\netcoreapp2.0'.
                   +03.6729025 i | | | | > Reading binary folders.
                   +03.6761842 i | | | | | > Reading files from 'C:\Dev\CK-Database-Projects\CK-DB\CK.DB.Acl.AclType\bin\Debug\netstandard2.0'.
                   +04.1327330 i | | | | | < 
                   +04.1335604 i | | | | <  | 1 conclusion:
                                 | | | |    | 1 folders read.
                   +04.1877956 i | | | | Creating provided Working Directory: C:\Dev\CK-Database-Projects\CK-DB\Tests\CK.DB.Acl.AclType.Tests\CKSetup-WorkingDir\.
                   +04.1906430 i | | | | Created setup folder in Working Directory: C:\Dev\CK-Database-Projects\CK-DB\Tests\CK.DB.Acl.AclType.Tests\CKSetup-WorkingDir\2018-04-13 08h41.50.3146177\.
                   +04.1911366   | | | < 
                   +04.1962068 i | | | > Resolving runtime support for 'C:\Dev\CK-Database-Projects\CK-DB\CK.DB.Acl.AclType\bin\Debug\netstandard2.0\'.
                   +04.1988950 i | | | | > Creating runtime dependencies resolver for C:\Dev\CK-Database-Projects\CK-DB\CK.DB.Acl.AclType\bin\Debug\netstandard2.0\.
                   +04.2039554 i | | | | | > Detecting runtimes for: CK.Setupable.Model/NetStandard20, CK.SqlServer.Setup.Model/NetStandard20, CK.StObj.Model/NetStandard20
                   +04.2295718 i | | | | | <  | 1 conclusion:
                                 | | | | |    | Single selected runtime: NetCoreApp20.
                   +04.2420208 i | | | | < 
                   +04.2436617 i | | | | > Initializing root dependencies.
                   +04.2611867   | | | | | Resolved required dependency -> CK.Setupable.Runtime/6.0.0-p05-00-develop-0049 to local CK.Setupable.Runtime/6.0.0-p05-00-develop-0049/NetCoreApp20/.
                   +04.2641814   | | | | | Resolved required dependency -> CK.SqlServer.Setup.Runtime/6.0.0-p05-00-develop-0049 to local CK.SqlServer.Setup.Runtime/6.0.0-p05-00-develop-0049/NetCoreApp20/.
                   +04.2643180   | | | | | Resolved required dependency -> CK.StObj.Runtime/6.0.0-p05-00-develop-0049 to local CK.StObj.Runtime/6.0.0-p05-00-develop-0049/NetCoreApp20/.
                   +04.2643827   | | | | | Resolved required dependency -> CKSetup.Runner/6.0.0-r09-00-develop-0055 to local CKSetup.Runner/6.0.0-r09-00-develop-0055/NetCoreApp20/.
                   +04.2682173 i | | | | < 
                   +04.2682401 i | | | | > Resolving dependencies.
                   +04.2699884   | | | | | Resolved required dependency -> CK.Setupable.Engine/6.0.0-p05-00-develop-0049 to local CK.Setupable.Engine/6.0.0-p05-00-develop-0049/NetCoreApp20/.
                   +04.2707440   | | | | | Resolved required dependency -> CK.SqlServer.Setup.Engine/6.0.0-p05-00-develop-0049 to local CK.SqlServer.Setup.Engine/6.0.0-p05-00-develop-0049/NetCoreApp20/.
                   +04.2708431   | | | | | Resolved required dependency -> CK.StObj.Engine/6.0.0-p05-00-develop-0049 to local CK.StObj.Engine/6.0.0-p05-00-develop-0049/NetCoreApp20/.
                   +04.2708993 i | | | | < 
                   +04.2796118 i | | | | > Selected 52 setup files.
                   +04.3161684 i | | | | < 
                   +04.3161956 i | | | < 
                   +04.3162072 i | | | > Copying files to 'C:\Dev\CK-Database-Projects\CK-DB\Tests\CK.DB.Acl.AclType.Tests\CKSetup-WorkingDir\2018-04-13 08h41.50.3146177\'.
                   +04.7311512 i | | | < 
                   +04.7315916 i | | | > Copying 21 files from bin folders.
                   +04.7694418 i | | | <  | 1 conclusion:
                                 | | |    | Skipped 6 file(s).
                   +04.7694708 i | | | > Generating CKSetup.Runner.Config.xml file.
                   +04.7761936 i | | | < 
                   +04.7779607 i | | | > Launching CKSetup.Runner process.
                   +04.8023021   | | | | > dotnet CKSetup.Runner.dll merge-deps /silent /logPipe:1912
                   +04.9829064 i | | | | | > Starting CKSetup.Runner - 6.0.0-rc.9.0.ci-develop.55 (6.0.0-r09-00-develop-0055) - SHA1: 33f3dae549f6c8e80766598e13c6c85668ad5968 - CommitDate: 2018-04-13 07:24:27Z
                   +04.9982323 i | | | | | | > Merging deps.json files.
                   +05.1695016 i | | | | | | | 'CK.DB.Acl.AclType.deps.json' - .NETStandard,Version=v2.0.
                   +05.1863631 i | | | | | | | 'CK.Setupable.Engine.deps.json' - .NETCoreApp,Version=v2.0.
                   +05.1906774 i | | | | | | | 'CK.Setupable.Runtime.deps.json' - .NETCoreApp,Version=v2.0.
                   +05.1951782 i | | | | | | | 'CK.SqlServer.Setup.Engine.deps.json' - .NETCoreApp,Version=v2.0.
                   +05.2075692 i | | | | | | | 'CK.SqlServer.Setup.Runtime.deps.json' - .NETCoreApp,Version=v2.0.
                   +05.2154851 i | | | | | | | 'CK.StObj.Engine.deps.json' - .NETCoreApp,Version=v2.0.
                   +05.2196277 i | | | | | | | 'CK.StObj.Runtime.deps.json' - .NETCoreApp,Version=v2.0.
                   +05.2276873 i | | | | | | | Merging 'CK.SqlServer.Setup.Engine.deps.json' - .NETCoreApp,Version=v2.0.
                   +05.2294701 i | | | | | | | Merging 'CK.SqlServer.Setup.Runtime.deps.json' - .NETCoreApp,Version=v2.0.
                   +05.2310467 i | | | | | | | Merging 'CK.Setupable.Engine.deps.json' - .NETCoreApp,Version=v2.0.
                   +05.2323658 i | | | | | | | Merging 'CK.Setupable.Runtime.deps.json' - .NETCoreApp,Version=v2.0.
                   +05.2337519 i | | | | | | | Merging 'CK.StObj.Engine.deps.json' - .NETCoreApp,Version=v2.0.
                   +05.2355306 i | | | | | | | Merging 'CK.StObj.Runtime.deps.json' - .NETCoreApp,Version=v2.0.
                   +05.2372897 i | | | | | | | Merging 'CK.DB.Acl.AclType.deps.json' - .NETStandard,Version=v2.0.
                   +05.2423716 i | | | | | | | Saving 'CKSetup.Runner.deps.json.merged'.
                   +05.3807912 i | | | | | | < 
                   +05.3945058 i | | | | | | No assembly load conflicts.
                   +05.4510029 i | | | | | < 
                   +05.4510181   | | | | < 
                   +05.4600242   | | | | > dotnet CKSetup.Runner.dll  /silent /logPipe:1972
                   +05.6492491 i | | | | | > Starting CKSetup.Runner - 6.0.0-rc.9.0.ci-develop.55 (6.0.0-r09-00-develop-0055) - SHA1: 33f3dae549f6c8e80766598e13c6c85668ad5968 - CommitDate: 2018-04-13 07:24:27Z
                   +05.7191377 i | | | | | | > Applying CKSetup configuration.
                   +05.7235319 i | | | | | | | Handling 1 BinPath(s).
                   +05.7256212 i | | | | | | < 
                   +05.7374115 i | | | | | | > Validating configuration.
                   +05.7453240 i | | | | | | < 
                   +05.7597717   | | | | | | > Creating and configuring 2 aspect(s).
                   +05.8349277   | | | | | | | > Configuring aspect 'CK.Setup.SetupableAspect'.
                   +05.8385963   | | | | | | | < 
                   +05.8508230   | | | | | | | > Configuring aspect 'CK.SqlServer.Setup.SqlSetupAspect'.
                   +05.8706369 i | | | | | | | | > Connection to Data Source=.;Initial Catalog=CKTEST_CK_DB_Acl_AclType;Integrated Security=True.
                   +06.1657611 i | | | | | | | | | Connected to database.
                   +06.1678800 i | | | | | | | | < 
                   +06.1693731 i | | | | | | | | Registering SqlVersionedItemReader on the default database as the version reader.
                   +06.1713826 i | | | | | | | | Registering SqlVersionedItemWriter on the default database as the version writer.
                   +06.1717690 i | | | | | | | | Registering SqlSetupSessionMemoryProvider on the default database as the memory provider.
                   +06.2354088   | | | | | | | < 
                   +06.2366373 i | | | | | | | > Executing initial 1 deferred actions.
                   +06.2379404 i | | | | | | | <  | 1 conclusion:
                                 | | | | | | |    | Executed 1 actions.
                   +06.2427866 i | | | | | | | No explicit ISimpleObjectActivator has been registered. Using a default SimpleObjectActivator.
                   +06.2428330   | | | | | | < 
                   +06.2469505 i | | | | | | > Building StObj objects.
                   +06.2727441 i | | | | | | | > Registering StObj types.
                   +06.2742412   | | | | | | | | > Registering 6 assemblies.
                   +06.2742908   | | | | | | | | | > Registering assembly 'CK.Setupable.Model'.
                   +06.2775769   | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | |    | 16 types(s) registered.
                   +06.2779567   | | | | | | | | | > Registering assembly 'CK.SqlServer.Setup.Model'.
                   +06.3146627   | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | |    | 43 types(s) registered.
                   +06.3147373   | | | | | | | | | > Registering assembly 'CK.StObj.Model'.
                   +06.3175196   | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | |    | 22 types(s) registered.
                   +06.3175803   | | | | | | | | | > Registering assembly 'CK.DB.Acl.AclType'.
                   +06.3294089   | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | |    | 3 types(s) registered.
                   +06.3294620   | | | | | | | | | > Registering assembly 'CK.DB.Acl'.
                   +06.3336706   | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | |    | 4 types(s) registered.
                   +06.3337367   | | | | | | | | | > Registering assembly 'CK.DB.Actor'.
                   +06.3352749   | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | |    | 6 types(s) registered.
                   +06.3353347   | | | | | | | | < 
                   +06.3378457   | | | | | | | | > Explicitely registering 0 type(s).
                   +06.3379385   | | | | | | | | < 
                   +06.3396807 i | | | | | | | < 
                   +06.3397097 i | | | | | | | > Resolving StObj dependency graph.
                   +06.3448496 i | | | | | | | | > Collecting all StObj information.
                   +06.3451159 i | | | | | | | | | > Collecting Ambient Contracts, Type structure and Poco.
                   +06.3479692 i | | | | | | | | | | > Creating Poco Types and PocoFactory.
                   +06.3785248 i | | | | | | | | | | < 
                   +06.4874314   | | | | | | | | | | > Ambient Contract discovering: 1 context(s).
                   +06.4915913   | | | | | | | | | | | > Ambient Contract for context '': 16 mappings for 14 concrete paths.
                   +06.4917596   | | | | | | | | | | | < 
                   +06.4917792   | | | | | | | | | | < 
                   +06.4917912 i | | | | | | | | | < 
                   +06.4978182 i | | | | | | | | | > Creating Structure Objects.
                   +06.4980944 i | | | | | | | | | | > Working on Context [].
                   +06.5337889 i | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | |    | 14 items created for 14 types.
                   +06.5338586 i | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | |    | 14 items created.
                   +06.5338902 i | | | | | | | | | > Handling dependencies.
                   +06.5353195 i | | | | | | | | | | > Working on Context [].
                   +06.5373620   | | | | | | | | | | | > Preparing '[]CK.SqlServer.Setup.SqlDefaultDatabase'.
                   +06.5500608   | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | |    | ItemKind is Group
                   +06.5501269   | | | | | | | | | | | > Preparing '[]CK.DB.Acl.AclType.AclTypeGrantLevelTable'.
                   +06.5503768   | | | | | | | | | | | | > Preparing '[]CK.DB.Acl.AclType.Package'.
                   +06.5514344   | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | |    | ItemKind is Container
                   +06.5593450   | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | |    | ItemKind is Container
                   +06.5594092   | | | | | | | | | | | > Preparing '[]CK.DB.Acl.AclType.AclTypeTable'.
                   +06.5595230   | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | |    | ItemKind is Container
                   +06.5595641   | | | | | | | | | | | > Preparing '[]CK.DB.Acl.AclConfigMemoryTable'.
                   +06.5596176   | | | | | | | | | | | | > Preparing '[]CK.DB.Acl.Package'.
                   +06.5596672   | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | |    | ItemKind is Container
                   +06.5597105   | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | |    | ItemKind is Container
                   +06.5597676   | | | | | | | | | | | > Preparing '[]CK.DB.Acl.AclConfigTable'.
                   +06.5598238   | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | |    | ItemKind is Container
                   +06.5598604   | | | | | | | | | | | > Preparing '[]CK.DB.Acl.AclTable'.
                   +06.5599108   | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | |    | ItemKind is Container
                   +06.5599474   | | | | | | | | | | | > Preparing '[]CK.DB.Actor.ActorProfileTable'.
                   +06.5599952   | | | | | | | | | | | | > Preparing '[]CK.DB.Actor.Package'.
                   +06.5600456   | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | |    | ItemKind is Container
                   +06.5600875   | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | |    | ItemKind is Container
                   +06.5601246   | | | | | | | | | | | > Preparing '[]CK.DB.Actor.ActorTable'.
                   +06.5601750   | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | |    | ItemKind is Container
                   +06.5602219   | | | | | | | | | | | > Preparing '[]CK.DB.Actor.GroupTable'.
                   +06.5602871   | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | |    | ItemKind is Container
                   +06.5603228   | | | | | | | | | | | > Preparing '[]CK.DB.Actor.UserTable'.
                   +06.5603759   | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | |    | ItemKind is Container
                   +06.5604339   | | | | | | | | | | | > Preparing '[]CK._g.poco.Factory'.
                   +06.5610033 W | | | | | | | | | | | | Since ItemKind is not specified on this base class ('[]CK._g.poco.Factory'), it defaults to SimpleItem. It should be explicitely set to either SimpleItem, Group or Container.
                   +06.5623568   | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | |    | ItemKind is Item
                   +06.5624027 i | | | | | | | | | | < 
                   +06.5634161 i | | | | | | | | | | > Working on Context [].
                   +06.5759673 i | | | | | | | | | | < 
                   +06.6341785 i | | | | | | | | | < 
                   +06.6342258 i | | | | | | | | | > Initializing object graph.
                   +06.6421034   | | | | | | | | | | > Constructing '[]CK._g.poco.Factory'.
                   +06.6443431   | | | | | | | | | | < 
                   +06.6449745   | | | | | | | | | | > Constructing '[]CK.SqlServer.Setup.SqlDefaultDatabase'.
                   +06.6487850   | | | | | | | | | | < 
                   +06.6493727   | | | | | | | | | | > Constructing '[]CK.DB.Actor.Package'.
                   +06.6518245   | | | | | | | | | | < 
                   +06.6519021   | | | | | | | | | | > Constructing '[]CK.DB.Actor.ActorTable'.
                   +06.6521556   | | | | | | | | | | < 
                   +06.6542221   | | | | | | | | | | > Constructing '[]CK.DB.Actor.GroupTable'.
                   +06.6544961   | | | | | | | | | | < 
                   +06.6545568   | | | | | | | | | | > Constructing '[]CK.DB.Actor.UserTable'.
                   +06.6547790   | | | | | | | | | | < 
                   +06.6548178   | | | | | | | | | | > Constructing '[]CK.DB.Actor.ActorProfileTable'.
                   +06.6550325   | | | | | | | | | | < 
                   +06.6550717   | | | | | | | | | | > Constructing '[]CK.DB.Acl.Package'.
                   +06.6553253   | | | | | | | | | | < 
                   +06.6553610   | | | | | | | | | | > Constructing '[]CK.DB.Acl.AclTable'.
                   +06.6555975   | | | | | | | | | | < 
                   +06.6556399   | | | | | | | | | | > Constructing '[]CK.DB.Acl.AclConfigMemoryTable'.
                   +06.6558563   | | | | | | | | | | < 
                   +06.6558942   | | | | | | | | | | > Constructing '[]CK.DB.Acl.AclConfigTable'.
                   +06.6561414   | | | | | | | | | | < 
                   +06.6561803   | | | | | | | | | | > Constructing '[]CK.DB.Acl.AclType.Package'.
                   +06.6563948   | | | | | | | | | | < 
                   +06.6564328   | | | | | | | | | | > Constructing '[]CK.DB.Acl.AclType.AclTypeTable'.
                   +06.6566389   | | | | | | | | | | < 
                   +06.6566737   | | | | | | | | | | > Constructing '[]CK.DB.Acl.AclType.AclTypeGrantLevelTable'.
                   +06.6569402   | | | | | | | | | | < 
                   +06.6569714 i | | | | | | | | | | > Setting Ambient Contracts.
                   +06.6585123 i | | | | | | | | | | | > Working on Context [].
                   +06.6602742 i | | | | | | | | | | | < 
                   +06.6603370 i | | | | | | | | | | < 
                   +06.6606056 i | | | | | | | | | < 
                   +06.6606230 i | | | | | | | | < 
                   +06.6606337 i | | | | | | | < 
                   +06.6606454 i | | | | | | < 
                   +06.6629882 i | | | | | | > Running Aspects.
                   +06.6632965 i | | | | | | | > Aspect: CK.Setup.SetupableAspect.
                   +06.6666474 i | | | | | | | | > Creating Setup Items from Structured Objects.
                   +06.6691094 i | | | | | | | | | > Building setupable items from 14 Structure Objects (calling IStObjSetupConfigurator.ConfigureDependentItem and IStObjSetupItemFactory.CreateDependentItem for each of them).
                   +06.7004226 i | | | | | | | | | | SqlPackage 'CK.DB.Actor.Package' uses its own full name as its SetupName.
                   +06.7133963 i | | | | | | | | | | SqlTable 'CK.DB.Actor.ActorTable' uses 'CK.ActorTable' as its SetupName.
                   +06.7141371 i | | | | | | | | | | SqlTable 'CK.DB.Actor.GroupTable' uses 'CK.GroupTable' as its SetupName.
                   +06.7144731 i | | | | | | | | | | SqlTable 'CK.DB.Actor.UserTable' uses 'CK.UserTable' as its SetupName.
                   +06.7147757 i | | | | | | | | | | SqlTable 'CK.DB.Actor.ActorProfileTable' uses 'CK.ActorProfileTable' as its SetupName.
                   +06.7152647 i | | | | | | | | | | SqlPackage 'CK.DB.Acl.Package' uses its own full name as its SetupName.
                   +06.7155499 i | | | | | | | | | | SqlTable 'CK.DB.Acl.AclTable' uses 'CK.AclTable' as its SetupName.
                   +06.7159055 i | | | | | | | | | | SqlTable 'CK.DB.Acl.AclConfigMemoryTable' uses 'CK.AclConfigMemoryTable' as its SetupName.
                   +06.7161536 i | | | | | | | | | | SqlTable 'CK.DB.Acl.AclConfigTable' uses 'CK.AclConfigTable' as its SetupName.
                   +06.7163759 i | | | | | | | | | | SqlPackage 'CK.DB.Acl.AclType.Package' uses its own full name as its SetupName.
                   +06.7165852 i | | | | | | | | | | SqlTable 'CK.DB.Acl.AclType.AclTypeTable' uses 'CK.AclTypeTable' as its SetupName.
                   +06.7168226 i | | | | | | | | | | SqlTable 'CK.DB.Acl.AclType.AclTypeGrantLevelTable' uses 'CK.AclTypeGrantLevelTable' as its SetupName.
                   +06.7169654 i | | | | | | | | | < 
                   +06.7186857 i | | | | | | | | | > Binding dependencies between Setupable items.
                   +06.7218562 i | | | | | | | | | < 
                   +06.7243012 i | | | | | | | | | > Dynamic initialization of Setup items.
                   +06.7406981 i | | | | | | | | | | > Executing 44 deferred actions.
                   +06.7413746 i | | | | | | | | | | | > Starting intialization round n°0.
                   +06.7453632 i | | | | | | | | | | | | > Handling: '[]db^CK.sActorCreate' in SqlObjectItem attribute of '[]db^CK.ActorTable'
                   +06.7485410   | | | | | | | | | | | | | > Loading '[]db^CK.sActorCreate' of '[]db^CK.ActorTable'.
                   +06.9522416   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sActorCreate.sql'.
                   +06.9523121 i | | | | | | | | | | | | < 
                   +06.9523617 i | | | | | | | | | | | | > Handling: '[]db^CK.vGroup' in SqlObjectItem attribute of '[]db^CK.GroupTable'
                   +06.9524246   | | | | | | | | | | | | | > Loading '[]db^CK.vGroup' of '[]db^CK.GroupTable'.
                   +06.9937038   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded View from file 'vGroup.sql'.
                   +06.9937619 i | | | | | | | | | | | | < 
                   +06.9949355 i | | | | | | | | | | | | > Handling: 'sGroupCreate' in 'CreateGroupAsync' SqlProcedure attribute of '[]db^CK.GroupTable'
                   +06.9955732   | | | | | | | | | | | | | > Loading '[]db^CK.sGroupCreate' of '[]db^CK.GroupTable'.
                   +07.0165999   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sGroupCreate.sql'.
                   +07.0166566 i | | | | | | | | | | | | < 
                   +07.0167097 i | | | | | | | | | | | | > Handling: 'sGroupDestroy' in 'DestroyGroupAsync' SqlProcedure attribute of '[]db^CK.GroupTable'
                   +07.0167650   | | | | | | | | | | | | | > Loading '[]db^CK.sGroupDestroy' of '[]db^CK.GroupTable'.
                   +07.0272295   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sGroupDestroy.sql'.
                   +07.0272723 i | | | | | | | | | | | | < 
                   +07.0273045 i | | | | | | | | | | | | > Handling: 'sGroupUserAdd' in 'AddUserAsync' SqlProcedure attribute of '[]db^CK.GroupTable'
                   +07.0273429   | | | | | | | | | | | | | > Loading '[]db^CK.sGroupUserAdd' of '[]db^CK.GroupTable'.
                   +07.0299155   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sGroupUserAdd.sql'.
                   +07.0299632 i | | | | | | | | | | | | < 
                   +07.0299887 i | | | | | | | | | | | | > Handling: 'sGroupUserRemove' in 'RemoveUserAsync' SqlProcedure attribute of '[]db^CK.GroupTable'
                   +07.0300333   | | | | | | | | | | | | | > Loading '[]db^CK.sGroupUserRemove' of '[]db^CK.GroupTable'.
                   +07.0314291   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sGroupUserRemove.sql'.
                   +07.0314840 i | | | | | | | | | | | | < 
                   +07.0315085 i | | | | | | | | | | | | > Handling: 'sGroupRemoveAllUsers' in 'RemoveAllUsersAsync' SqlProcedure attribute of '[]db^CK.GroupTable'
                   +07.0315826   | | | | | | | | | | | | | > Loading '[]db^CK.sGroupRemoveAllUsers' of '[]db^CK.GroupTable'.
                   +07.0461482   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sGroupRemoveAllUsers.sql'.
                   +07.0462022 i | | | | | | | | | | | | < 
                   +07.0462477 i | | | | | | | | | | | | > Handling: '[]db^CK.vUser' in SqlObjectItem attribute of '[]db^CK.UserTable'
                   +07.0463865   | | | | | | | | | | | | | > Loading '[]db^CK.vUser' of '[]db^CK.UserTable'.
                   +07.0468411   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded View from file 'vUser.sql'.
                   +07.0469527 i | | | | | | | | | | | | < 
                   +07.0469786 i | | | | | | | | | | | | > Handling: 'sUserCreate' in 'CreateUserAsync' SqlProcedure attribute of '[]db^CK.UserTable'
                   +07.0470223   | | | | | | | | | | | | | > Loading '[]db^CK.sUserCreate' of '[]db^CK.UserTable'.
                   +07.0489229   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sUserCreate.sql'.
                   +07.0489698 i | | | | | | | | | | | | < 
                   +07.0489943 i | | | | | | | | | | | | > Handling: 'sUserUserNameSet' in 'UserNameSetAsync' SqlProcedure attribute of '[]db^CK.UserTable'
                   +07.0490416   | | | | | | | | | | | | | > Loading '[]db^CK.sUserUserNameSet' of '[]db^CK.UserTable'.
                   +07.0547023   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sUserUserNameSet.sql'.
                   +07.0547581 i | | | | | | | | | | | | < 
                   +07.0547871 i | | | | | | | | | | | | > Handling: 'sUserDestroy' in 'DestroyUserAsync' SqlProcedure attribute of '[]db^CK.UserTable'
                   +07.0548375   | | | | | | | | | | | | | > Loading '[]db^CK.sUserDestroy' of '[]db^CK.UserTable'.
                   +07.0561008   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sUserDestroy.sql'.
                   +07.0561503 i | | | | | | | | | | | | < 
                   +07.0561793 i | | | | | | | | | | | | > Handling: 'sUserRemoveFromAllGroups' in 'RemoveFromAllGroupsAsync' SqlProcedure attribute of '[]db^CK.UserTable'
                   +07.0562333   | | | | | | | | | | | | | > Loading '[]db^CK.sUserRemoveFromAllGroups' of '[]db^CK.UserTable'.
                   +07.0570205   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sUserRemoveFromAllGroups.sql'.
                   +07.0570495 i | | | | | | | | | | | | < 
                   +07.0570821 i | | | | | | | | | | | | > Handling: '[]db^CK.DB.Acl.Package([]db^CK.sGroupDestroy)' in SqlObjectItem attribute of '[]db^CK.DB.Acl.Package'
                   +07.0571258   | | | | | | | | | | | | | > Loading '[]db^CK.DB.Acl.Package([]db^CK.sGroupDestroy)' of '[]db^CK.DB.Acl.Package'.
                   +07.0734571   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Transformer from file 'sGroupDestroy.tql'.
                   +07.0735009 i | | | | | | | | | | | | < 
                   +07.0735187 i | | | | | | | | | | | | > Handling: '[]db^CK.DB.Acl.Package([]db^CK.sUserDestroy)' in SqlObjectItem attribute of '[]db^CK.DB.Acl.Package'
                   +07.0735495   | | | | | | | | | | | | | > Loading '[]db^CK.DB.Acl.Package([]db^CK.sUserDestroy)' of '[]db^CK.DB.Acl.Package'.
                   +07.0738374   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Transformer from file 'sUserDestroy.tql'.
                   +07.0738673 i | | | | | | | | | | | | < 
                   +07.0738838 i | | | | | | | | | | | | > Handling: '[]db^CK.vAclActorReason' in SqlObjectItem attribute of '[]db^CK.AclTable'
                   +07.0739186   | | | | | | | | | | | | | > Loading '[]db^CK.vAclActorReason' of '[]db^CK.AclTable'.
                   +07.0951430   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded View from file 'vAclActorReason.sql'.
                   +07.0951957 i | | | | | | | | | | | | < 
                   +07.0952211 i | | | | | | | | | | | | > Handling: '[]db^CK.vAclActor' in SqlObjectItem attribute of '[]db^CK.AclTable'
                   +07.0952608   | | | | | | | | | | | | | > Loading '[]db^CK.vAclActor' of '[]db^CK.AclTable'.
                   +07.0974072   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded View from file 'vAclActor.sql'.
                   +07.0974536 i | | | | | | | | | | | | < 
                   +07.0975134 i | | | | | | | | | | | | > Handling: 'sAclCreate' in 'CreateAclAsync' SqlProcedure attribute of '[]db^CK.AclTable'
                   +07.0975536   | | | | | | | | | | | | | > Loading '[]db^CK.sAclCreate' of '[]db^CK.AclTable'.
                   +07.0978276   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sAclCreate.sql'.
                   +07.0978848 i | | | | | | | | | | | | < 
                   +07.0979075 i | | | | | | | | | | | | > Handling: 'sAclDestroy' in 'DestroyAclAsync' SqlProcedure attribute of '[]db^CK.AclTable'
                   +07.0979472   | | | | | | | | | | | | | > Loading '[]db^CK.sAclDestroy' of '[]db^CK.AclTable'.
                   +07.0982244   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sAclDestroy.sql'.
                   +07.0982578 i | | | | | | | | | | | | < 
                   +07.0982775 i | | | | | | | | | | | | > Handling: 'sAclGrantSet' in 'AclGrantSetAsync' SqlProcedure attribute of '[]db^CK.AclTable'
                   +07.0983225   | | | | | | | | | | | | | > Loading '[]db^CK.sAclGrantSet' of '[]db^CK.AclTable'.
                   +07.1040041   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sAclGrantSet.sql'.
                   +07.1040536 i | | | | | | | | | | | | < 
                   +07.1040898 i | | | | | | | | | | | | > Handling: 'fAclGrantLevel' in 'GetGrantLevelAsync' SqlScalarFunction attribute of '[]db^CK.AclTable'
                   +07.1041616   | | | | | | | | | | | | | > Loading '[]db^CK.fAclGrantLevel' of '[]db^CK.AclTable'.
                   +07.1174518   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Function from file 'fAclGrantLevel.sql'.
                   +07.1175085 i | | | | | | | | | | | | < 
                   +07.1175576 i | | | | | | | | | | | | > Handling: '[]db^CK.vAclConfigMemory' in SqlObjectItem attribute of '[]db^CK.AclConfigMemoryTable'
                   +07.1176035   | | | | | | | | | | | | | > Loading '[]db^CK.vAclConfigMemory' of '[]db^CK.AclConfigMemoryTable'.
                   +07.1180756   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded View from file 'vAclConfigMemory.sql'.
                   +07.1181153 i | | | | | | | | | | | | < 
                   +07.1181372 i | | | | | | | | | | | | > Handling: '[]db^CK.vAclConfig' in SqlObjectItem attribute of '[]db^CK.AclConfigTable'
                   +07.1181858   | | | | | | | | | | | | | > Loading '[]db^CK.vAclConfig' of '[]db^CK.AclConfigTable'.
                   +07.1184942   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded View from file 'vAclConfig.sql'.
                   +07.1185335 i | | | | | | | | | | | | < 
                   +07.1185531 i | | | | | | | | | | | | > Handling: '[]db^CK.AclTypeTable([]db^CK.sAclGrantSet)' in SqlObjectItem attribute of '[]db^CK.AclTypeTable'
                   +07.1186022   | | | | | | | | | | | | | > Loading '[]db^CK.AclTypeTable([]db^CK.sAclGrantSet)' of '[]db^CK.AclTypeTable'.
                   +07.1188052   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Transformer from file 'sAclGrantSet.tql'.
                   +07.1188445 i | | | | | | | | | | | | < 
                   +07.1188673 i | | | | | | | | | | | | > Handling: 'sAclTypeCreate' in 'CreateAclTypeAsync' SqlProcedure attribute of '[]db^CK.AclTypeTable'
                   +07.1189119   | | | | | | | | | | | | | > Loading '[]db^CK.sAclTypeCreate' of '[]db^CK.AclTypeTable'.
                   +07.1193135   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sAclTypeCreate.sql'.
                   +07.1193653 i | | | | | | | | | | | | < 
                   +07.1193885 i | | | | | | | | | | | | > Handling: 'sAclTypeDestroy' in 'DestroyAclTypeAsync' SqlProcedure attribute of '[]db^CK.AclTypeTable'
                   +07.1194318   | | | | | | | | | | | | | > Loading '[]db^CK.sAclTypeDestroy' of '[]db^CK.AclTypeTable'.
                   +07.1197241   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sAclTypeDestroy.sql'.
                   +07.1197696 i | | | | | | | | | | | | < 
                   +07.1197950 i | | | | | | | | | | | | > Handling: 'sAclTypeConstrainedGrantLevelSet' in 'SetConstrainedGrantLevelAsync' SqlProcedure attribute of '[]db^CK.AclTypeTable'
                   +07.1198397   | | | | | | | | | | | | | > Loading '[]db^CK.sAclTypeConstrainedGrantLevelSet' of '[]db^CK.AclTypeTable'.
                   +07.1225966   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sAclTypeConstrainedGrantLevelSet.sql'.
                   +07.1226376 i | | | | | | | | | | | | < 
                   +07.1226573 i | | | | | | | | | | | | > Handling: 'sAclTypeGrantLevelSet' in 'SetGrantLevelAsync' SqlProcedure attribute of '[]db^CK.AclTypeTable'
                   +07.1226907   | | | | | | | | | | | | | > Loading '[]db^CK.sAclTypeGrantLevelSet' of '[]db^CK.AclTypeTable'.
                   +07.1237135   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Procedure from file 'sAclTypeGrantLevelSet.sql'.
                   +07.1237613 i | | | | | | | | | | | | < 
                   +07.1238108 i | | | | | | | | | | | | > Handling: 'sAclCreate' in 'CreateAclAsync' SqlProcedure attribute of '[]db^CK.AclTypeTable'
                   +07.1238983   | | | | | | | | | | | | | > Loading '[]db^CK.AclTypeTable([]db^CK.sAclCreate)' of '[]db^CK.AclTypeTable'.
                   +07.1383888   | | | | | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | | | | | |    | Loaded Transformer from file 'sAclCreate.tql'.
                   +07.1384428 i | | | | | | | | | | | | < 
                   +07.1384700 i | | | | | | | | | | | < 
                   +07.1384807 i | | | | | | | | | | < 
                   +07.1384919 i | | | | | | | | | < 
                   +07.1389694 i | | | | | | | | < 
                   +07.1421610   | | | | | | | | > Installing CKCore kernel.
                   +07.2463275   | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | |    | Already installed in version 15.
                   +07.2905680 i | | | | | | | | > Reading original versions.
                   +07.2923240   | | | | | | | | | > Installing SqlVersionedItemRepository store.
                   +07.3008273   | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | |    | Already installed in version 1.
                   +07.3155494 i | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | |    | Got 24 versions.
                   +07.3181765 i | | | | | | | | > Setupable Core Engine initialization.
                   +07.3184184 i | | | | | | | | | Starting a new setup.
                   +07.3205344 i | | | | | | | | < 
                   +07.3205715 i | | | | | | | | > Register step.
                   +07.3668380 i | | | | | | | | | > Instanciating drivers for 86 items.
                   +07.3863136 i | | | | | | | | | < 
                   +07.3865884 i | | | | | | | | | > Calling PreInit on 86 drivers.
                   +07.4021214 i | | | | | | | | | | 0 sql scripts in resource found for 'CK.ActorTable' in 'CK.DB.Actor:CK.DB.Actor.Res.*.
                   +07.4123908 i | | | | | | | | | | 1 sql scripts in resource found for 'Model.CK.ActorTable' in 'CK.DB.Actor:CK.DB.Actor.Res.*.
                   +07.4204091 i | | | | | | | | | | 0 sql scripts in resource found for 'CK.GroupTable' in 'CK.DB.Actor:CK.DB.Actor.Res.*.
                   +07.4206683 i | | | | | | | | | | 2 sql scripts in resource found for 'Model.CK.GroupTable' in 'CK.DB.Actor:CK.DB.Actor.Res.*.
                   +07.4212047 i | | | | | | | | | | 0 sql scripts in resource found for 'CK.UserTable' in 'CK.DB.Actor:CK.DB.Actor.Res.*.
                   +07.4216344 i | | | | | | | | | | 5 sql scripts in resource found for 'Model.CK.UserTable' in 'CK.DB.Actor:CK.DB.Actor.Res.*.
                   +07.4223360 i | | | | | | | | | | 0 sql scripts in resource found for 'CK.ActorProfileTable' in 'CK.DB.Actor:CK.DB.Actor.Res.*.
                   +07.4224712 i | | | | | | | | | | 1 sql scripts in resource found for 'Model.CK.ActorProfileTable' in 'CK.DB.Actor:CK.DB.Actor.Res.*.
                   +07.4228104 i | | | | | | | | | | 0 sql scripts in resource found for 'CK.DB.Actor.Package' in 'CK.DB.Actor:CK.DB.Actor.Res.*.
                   +07.4229411 i | | | | | | | | | | 0 sql scripts in resource found for 'Model.CK.DB.Actor.Package' in 'CK.DB.Actor:CK.DB.Actor.Res.*.
                   +07.4234636 i | | | | | | | | | | 0 sql scripts in resource found for 'CK.AclTable' in 'CK.DB.Acl:CK.DB.Acl.Res.*.
                   +07.4236550 i | | | | | | | | | | 1 sql scripts in resource found for 'Model.CK.AclTable' in 'CK.DB.Acl:CK.DB.Acl.Res.*.
                   +07.4241428 i | | | | | | | | | | 0 sql scripts in resource found for 'CK.AclConfigMemoryTable' in 'CK.DB.Acl:CK.DB.Acl.Res.*.
                   +07.4243097 i | | | | | | | | | | 2 sql scripts in resource found for 'Model.CK.AclConfigMemoryTable' in 'CK.DB.Acl:CK.DB.Acl.Res.*.
                   +07.4245689 i | | | | | | | | | | 0 sql scripts in resource found for 'CK.AclConfigTable' in 'CK.DB.Acl:CK.DB.Acl.Res.*.
                   +07.4246814 i | | | | | | | | | | 1 sql scripts in resource found for 'Model.CK.AclConfigTable' in 'CK.DB.Acl:CK.DB.Acl.Res.*.
                   +07.4249206 i | | | | | | | | | | 0 sql scripts in resource found for 'CK.DB.Acl.Package' in 'CK.DB.Acl:CK.DB.Acl.Res.*.
                   +07.4249835 i | | | | | | | | | | 0 sql scripts in resource found for 'Model.CK.DB.Acl.Package' in 'CK.DB.Acl:CK.DB.Acl.Res.*.
                   +07.4252875 i | | | | | | | | | | 0 sql scripts in resource found for 'CK.AclTypeTable' in 'CK.DB.Acl.AclType:CK.DB.Acl.AclType.Res.*.
                   +07.4254231 i | | | | | | | | | | 1 sql scripts in resource found for 'Model.CK.AclTypeTable' in 'CK.DB.Acl.AclType:CK.DB.Acl.AclType.Res.*.
                   +07.4258538 i | | | | | | | | | | 0 sql scripts in resource found for 'CK.AclTypeGrantLevelTable' in 'CK.DB.Acl.AclType:CK.DB.Acl.AclType.Res.*.
                   +07.4259734 i | | | | | | | | | | 1 sql scripts in resource found for 'Model.CK.AclTypeGrantLevelTable' in 'CK.DB.Acl.AclType:CK.DB.Acl.AclType.Res.*.
                   +07.4262705 i | | | | | | | | | | 0 sql scripts in resource found for 'CK.DB.Acl.AclType.Package' in 'CK.DB.Acl.AclType:CK.DB.Acl.AclType.Res.*.
                   +07.4263486 i | | | | | | | | | | 0 sql scripts in resource found for 'Model.CK.DB.Acl.AclType.Package' in 'CK.DB.Acl.AclType:CK.DB.Acl.AclType.Res.*.
                   +07.4269032 i | | | | | | | | | < 
                   +07.4269345 i | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | |    | 86 Setup items registered.
                   +07.4270536 i | | | | | | | | > Init step.
                   +07.4298132   | | | | | | | | | > Raising Init setup event.
                   +07.4298708   | | | | | | | | | < 
                   +07.4299355 i | | | | | | | | | > Initializing []CK._g.poco.Factory
                   +07.4332230 i | | | | | | | | | < 
                   +07.4332681 i | | | | | | | | | > Initializing []db^SqlDatabase.Connection
                   +07.4383245   | | | | | | | | | | if not exists(select 1 from sys.schemas where name = 'CK') begin exec( 'create schema [CK]' ); end
                   +07.4387248   | | | | | | | | | | GO
                   +07.4442798   | | | | | | | | | | -- Ensure that snapshot_isolation and read_committed_snapshot are on for this db.
                                 | | | | | | | | | |   declare @dbName sysname = DB_NAME();
                                 | | | | | | | | | |   declare @dbNameQ sysname = QUOTENAME(@dbName);
                                 | | | | | | | | | |   declare @isSingleUser bit = 0;
                                 | | | | | | | | | |   declare @isRCSEnabled int;
                                 | | | | | | | | | |   select @isRCSEnabled = is_read_committed_snapshot_on from sys.databases where name = @dbName;
                                 | | | | | | | | | |   if @isRCSEnabled = 0
                                 | | | | | | | | | |   begin
                                 | | | | | | | | | |       exec( 'alter database '+@dbNameQ+' set single_user with rollback immediate;' );
                                 | | | | | | | | | |       set @isSingleUser = 1;
                                 | | | | | | | | | |       exec( 'alter database '+@dbNameQ+' set read_committed_snapshot on;' );
                                 | | | | | | | | | |   end;
                                 | | | | | | | | | |    
                                 | | | | | | | | | |   declare @isSIEnabled int;
                                 | | | | | | | | | |   select @isSIEnabled = snapshot_isolation_state from sys.databases where name = @dbName;
                                 | | | | | | | | | |   if @isSIEnabled = 0
                                 | | | | | | | | | |   begin
                                 | | | | | | | | | |       if @isSingleUser = 0 exec ('alter database ' + @dbNameQ + ' set single_user with rollback immediate;');
                                 | | | | | | | | | |       exec( 'alter database '+@dbNameQ+' set allow_snapshot_isolation on;' );
                                 | | | | | | | | | |   end;
                                 | | | | | | | | | |    
                                 | | | | | | | | | |   if @isSingleUser = 1 exec( 'alter database '+@dbNameQ+' set multi_user;' );
                   +07.4444203   | | | | | | | | | | GO
                   +07.5130879 i | | | | | | | | | < 
                   +07.5131169 i | | | | | | | | | > Initializing []db^Model.SqlDatabase.Head
                   +07.5134931 i | | | | | | | | | < 
                   +07.5135088 i | | | | | | | | | > Initializing []db^Model.CK.DB.Actor.Package.Head
                   +07.5135355 i | | | | | | | | | < 
                   +07.5135498 i | | | | | | | | | > Initializing []db^Model.CK.ActorTable.Head
                   +07.5135851 i | | | | | | | | | < 
                   +07.5136168 i | | | | | | | | | > Initializing []db^Model.CK.ActorTable
                   +07.5138260 i | | | | | | | | | < 
                   +07.5138394 i | | | | | | | | | > Initializing []db^Model.CK.GroupTable.Head
                   +07.5138720 i | | | | | | | | | < 
                   +07.5138979 i | | | | | | | | | > Initializing []db^Model.CK.UserTable.Head
                   +07.5139626 i | | | | | | | | | < 
                   +07.5139787 i | | | | | | | | | > Initializing []db^Model.CK.GroupTable
                   +07.5140099 i | | | | | | | | | < 
                   +07.5140188 i | | | | | | | | | > Initializing []db^Model.CK.UserTable
                   +07.5140469 i | | | | | | | | | < 
                   +07.5140585 i | | | | | | | | | > Initializing []db^Model.CK.ActorProfileTable.Head
                   +07.5140893 i | | | | | | | | | < 
                   +07.5141005 i | | | | | | | | | > Initializing []db^Model.CK.ActorProfileTable
                   +07.5141313 i | | | | | | | | | < 
                   +07.5141518 i | | | | | | | | | > Initializing []db^Model.CK.DB.Actor.Package
                   +07.5141888 i | | | | | | | | | < 
                   +07.5142026 i | | | | | | | | | > Initializing []db^Model.CK.DB.Acl.Package.Head
                   +07.5142334 i | | | | | | | | | < 
                   +07.5142450 i | | | | | | | | | > Initializing []db^Model.CK.AclTable.Head
                   +07.5142718 i | | | | | | | | | < 
                   +07.5142856 i | | | | | | | | | > Initializing []db^Model.CK.AclTable
                   +07.5143178 i | | | | | | | | | < 
                   +07.5143334 i | | | | | | | | | > Initializing []db^Model.CK.AclConfigMemoryTable.Head
                   +07.5143624 i | | | | | | | | | < 
                   +07.5143744 i | | | | | | | | | > Initializing []db^Model.CK.AclConfigMemoryTable
                   +07.5144070 i | | | | | | | | | < 
                   +07.5144168 i | | | | | | | | | > Initializing []db^Model.CK.AclConfigTable.Head
                   +07.5144570 i | | | | | | | | | < 
                   +07.5144717 i | | | | | | | | | > Initializing []db^Model.CK.AclConfigTable
                   +07.5145034 i | | | | | | | | | < 
                   +07.5145150 i | | | | | | | | | > Initializing []db^Model.CK.DB.Acl.Package
                   +07.5145404 i | | | | | | | | | < 
                   +07.5145507 i | | | | | | | | | > Initializing []db^Model.CK.DB.Acl.AclType.Package.Head
                   +07.5146404 i | | | | | | | | | < 
                   +07.5146685 i | | | | | | | | | > Initializing []db^Model.CK.AclTypeTable.Head
                   +07.5148318 i | | | | | | | | | < 
                   +07.5148466 i | | | | | | | | | > Initializing []db^Model.CK.AclTypeTable
                   +07.5149001 i | | | | | | | | | < 
                   +07.5149220 i | | | | | | | | | > Initializing []db^Model.CK.AclTypeGrantLevelTable.Head
                   +07.5149760 i | | | | | | | | | < 
                   +07.5149938 i | | | | | | | | | > Initializing []db^Model.CK.AclTypeGrantLevelTable
                   +07.5150460 i | | | | | | | | | < 
                   +07.5150612 i | | | | | | | | | > Initializing []db^Model.CK.DB.Acl.AclType.Package
                   +07.5150933 i | | | | | | | | | < 
                   +07.5151076 i | | | | | | | | | > Initializing []db^Model.SqlDatabase
                   +07.5151590 i | | | | | | | | | < 
                   +07.5151773 i | | | | | | | | | > Initializing []db^SqlDatabase.Head
                   +07.5152175 i | | | | | | | | | < 
                   +07.5152375 i | | | | | | | | | > Initializing []db^CK.DB.Actor.Package.Head
                   +07.5153014 i | | | | | | | | | < 
                   +07.5153165 i | | | | | | | | | > Initializing []db^CK.ActorTable.Head
                   +07.5153674 i | | | | | | | | | < 
                   +07.5153861 i | | | | | | | | | > Initializing []db^CK.sActorCreate
                   +07.5154379 i | | | | | | | | | < 
                   +07.5154607 i | | | | | | | | | > Initializing []db^CK.ActorTable
                   +07.5155182 i | | | | | | | | | < 
                   +07.5155343 i | | | | | | | | | > Initializing []db^CK.GroupTable.Head
                   +07.5155892 i | | | | | | | | | < 
                   +07.5156075 i | | | | | | | | | > Initializing []db^CK.UserTable.Head
                   +07.5156575 i | | | | | | | | | < 
                   +07.5156744 i | | | | | | | | | > Initializing []db^CK.sGroupCreate
                   +07.5157293 i | | | | | | | | | < 
                   +07.5157458 i | | | | | | | | | > Initializing []db^CK.sGroupUserAdd
                   +07.5157891 i | | | | | | | | | < 
                   +07.5158016 i | | | | | | | | | > Initializing []db^CK.sGroupUserRemove
                   +07.5158556 i | | | | | | | | | < 
                   +07.5158797 i | | | | | | | | | > Initializing []db^CK.sUserCreate
                   +07.5159337 i | | | | | | | | | < 
                   +07.5159493 i | | | | | | | | | > Initializing []db^CK.sUserUserNameSet
                   +07.5160216 i | | | | | | | | | < 
                   +07.5160412 i | | | | | | | | | > Initializing []db^CK.vGroup
                   +07.5160841 i | | | | | | | | | < 
                   +07.5161042 i | | | | | | | | | > Initializing []db^CK.vUser
                   +07.5161862 i | | | | | | | | | < 
                   +07.5162054 i | | | | | | | | | > Initializing []db^CK.sGroupRemoveAllUsers
                   +07.5162326 i | | | | | | | | | < 
                   +07.5162589 i | | | | | | | | | > Initializing []db^CK.sUserRemoveFromAllGroups
                   +07.5162933 i | | | | | | | | | < 
                   +07.5163138 i | | | | | | | | | > Initializing []db^CK.sGroupDestroy
                   +07.5163571 i | | | | | | | | | < 
                   +07.5163727 i | | | | | | | | | > Initializing []db^CK.sUserDestroy
                   +07.5163968 i | | | | | | | | | < 
                   +07.5164071 i | | | | | | | | | > Initializing []db^CK.GroupTable
                   +07.5164468 i | | | | | | | | | < 
                   +07.5164646 i | | | | | | | | | > Initializing []db^CK.UserTable
                   +07.5165119 i | | | | | | | | | < 
                   +07.5165325 i | | | | | | | | | > Initializing []db^CK.ActorProfileTable.Head
                   +07.5165869 i | | | | | | | | | < 
                   +07.5165981 i | | | | | | | | | > Initializing []db^CK.ActorProfileTable
                   +07.5166405 i | | | | | | | | | < 
                   +07.5166579 i | | | | | | | | | > Initializing []db^CK.DB.Actor.Package
                   +07.5167172 i | | | | | | | | | < 
                   +07.5167351 i | | | | | | | | | > Initializing []db^CK.DB.Acl.Package.Head
                   +07.5167837 i | | | | | | | | | < 
                   +07.5168065 i | | | | | | | | | > Initializing []db^CK.AclTable.Head
                   +07.5168680 i | | | | | | | | | < 
                   +07.5168912 i | | | | | | | | | > Initializing []db^CK.DB.Acl.Package([]db^CK.sGroupDestroy)
                   +07.5169390 i | | | | | | | | | < 
                   +07.5169564 i | | | | | | | | | > Initializing []db^CK.DB.Acl.Package([]db^CK.sUserDestroy)
                   +07.5170091 i | | | | | | | | | < 
                   +07.5170354 i | | | | | | | | | > Initializing []db^CK.fAclGrantLevel
                   +07.5171001 i | | | | | | | | | < 
                   +07.5171255 i | | | | | | | | | > Initializing []db^CK.sAclCreate
                   +07.5171894 i | | | | | | | | | < 
                   +07.5172050 i | | | | | | | | | > Initializing []db^CK.sAclDestroy
                   +07.5172728 i | | | | | | | | | < 
                   +07.5172875 i | | | | | | | | | > Initializing []db^CK.sAclGrantSet
                   +07.5173487 i | | | | | | | | | < 
                   +07.5173674 i | | | | | | | | | > Initializing []db^CK.sGroupDestroy#transform
                   +07.5174111 i | | | | | | | | | < 
                   +07.5174259 i | | | | | | | | | > Initializing []db^CK.sUserDestroy#transform
                   +07.5174567 i | | | | | | | | | < 
                   +07.5174723 i | | | | | | | | | > Initializing []db^CK.vAclActor
                   +07.5175098 i | | | | | | | | | < 
                   +07.5175289 i | | | | | | | | | > Initializing []db^CK.vAclActorReason
                   +07.5175874 i | | | | | | | | | < 
                   +07.5176039 i | | | | | | | | | > Initializing []db^CK.AclTable
                   +07.5176758 i | | | | | | | | | < 
                   +07.5176945 i | | | | | | | | | > Initializing []db^CK.AclConfigMemoryTable.Head
                   +07.5177467 i | | | | | | | | | < 
                   +07.5177664 i | | | | | | | | | > Initializing []db^CK.vAclConfigMemory
                   +07.5178079 i | | | | | | | | | < 
                   +07.5178668 i | | | | | | | | | > Initializing []db^CK.AclConfigMemoryTable
                   +07.5179288 i | | | | | | | | | < 
                   +07.5179462 i | | | | | | | | | > Initializing []db^CK.AclConfigTable.Head
                   +07.5179752 i | | | | | | | | | < 
                   +07.5179962 i | | | | | | | | | > Initializing []db^CK.vAclConfig
                   +07.5180395 i | | | | | | | | | < 
                   +07.5180586 i | | | | | | | | | > Initializing []db^CK.AclConfigTable
                   +07.5181001 i | | | | | | | | | < 
                   +07.5181198 i | | | | | | | | | > Initializing []db^CK.DB.Acl.Package
                   +07.5181823 i | | | | | | | | | < 
                   +07.5181984 i | | | | | | | | | > Initializing []db^CK.DB.Acl.AclType.Package.Head
                   +07.5182564 i | | | | | | | | | < 
                   +07.5182693 i | | | | | | | | | > Initializing []db^CK.AclTypeTable.Head
                   +07.5183796 i | | | | | | | | | < 
                   +07.5183952 i | | | | | | | | | > Initializing []db^CK.AclTypeTable([]db^CK.sAclCreate)
                   +07.5184478 i | | | | | | | | | < 
                   +07.5184630 i | | | | | | | | | > Initializing []db^CK.AclTypeTable([]db^CK.sAclGrantSet)
                   +07.5185090 i | | | | | | | | | < 
                   +07.5185317 i | | | | | | | | | > Initializing []db^CK.sAclTypeConstrainedGrantLevelSet
                   +07.5185875 i | | | | | | | | | < 
                   +07.5186027 i | | | | | | | | | > Initializing []db^CK.sAclTypeCreate
                   +07.5186495 i | | | | | | | | | < 
                   +07.5186732 i | | | | | | | | | > Initializing []db^CK.sAclTypeDestroy
                   +07.5187116 i | | | | | | | | | < 
                   +07.5187714 i | | | | | | | | | > Initializing []db^CK.sAclTypeGrantLevelSet
                   +07.5188419 i | | | | | | | | | < 
                   +07.5188562 i | | | | | | | | | > Initializing []db^CK.AclTypeTable
                   +07.5189088 i | | | | | | | | | < 
                   +07.5189235 i | | | | | | | | | > Initializing []db^CK.sAclCreate#transform
                   +07.5189874 i | | | | | | | | | < 
                   +07.5190061 i | | | | | | | | | > Initializing []db^CK.sAclGrantSet#transform
                   +07.5190431 i | | | | | | | | | < 
                   +07.5190579 i | | | | | | | | | > Initializing []db^CK.AclTypeGrantLevelTable.Head
                   +07.5191854 i | | | | | | | | | < 
                   +07.5191997 i | | | | | | | | | > Initializing []db^CK.AclTypeGrantLevelTable
                   +07.5192381 i | | | | | | | | | < 
                   +07.5192582 i | | | | | | | | | > Initializing []db^CK.DB.Acl.AclType.Package
                   +07.5192850 i | | | | | | | | | < 
                   +07.5192957 i | | | | | | | | | > Initializing []db^SqlDatabase
                   +07.5193465 i | | | | | | | | | < 
                   +07.5193733 i | | | | | | | | < 
                   +07.5193916 i | | | | | | | | > Install step.
                   +07.5207843   | | | | | | | | | > Raising Install setup event.
                   +07.5208289   | | | | | | | | | < 
                   +07.5216251 i | | | | | | | | | > Installing []CK._g.poco.Factory (unversioned).
                   +07.5232954 i | | | | | | | | | < 
                   +07.5233328 i | | | | | | | | | > Installing []db^SqlDatabase.Connection (unversioned).
                   +07.5233801 i | | | | | | | | | < 
                   +07.5233962 i | | | | | | | | | > Installing []db^Model.SqlDatabase.Head (unversioned).
                   +07.5236251 i | | | | | | | | | < 
                   +07.5238398 i | | | | | | | | | > Installing []db^Model.CK.DB.Actor.Package.Head (= 5.0.0 =).
                   +07.5238813 i | | | | | | | | | < 
                   +07.5239049 i | | | | | | | | | > Installing []db^Model.CK.ActorTable.Head (= 5.0.0 =).
                   +07.5239437 i | | | | | | | | | < 
                   +07.5239616 i | | | | | | | | | > Installing []db^Model.CK.ActorTable (= 5.0.0 =).
                   +07.5241535 i | | | | | | | | | < 
                   +07.5241767 i | | | | | | | | | > Installing []db^Model.CK.GroupTable.Head (= 5.0.1 =).
                   +07.5242142 i | | | | | | | | | < 
                   +07.5242481 i | | | | | | | | | > Installing []db^Model.CK.UserTable.Head (= 5.0.3 =).
                   +07.5242807 i | | | | | | | | | < 
                   +07.5243066 i | | | | | | | | | > Installing []db^Model.CK.GroupTable (= 5.0.1 =).
                   +07.5243467 i | | | | | | | | | < 
                   +07.5243838 i | | | | | | | | | > Installing []db^Model.CK.UserTable (= 5.0.3 =).
                   +07.5244212 i | | | | | | | | | < 
                   +07.5244387 i | | | | | | | | | > Installing []db^Model.CK.ActorProfileTable.Head (= 5.0.0 =).
                   +07.5244815 i | | | | | | | | | < 
                   +07.5244962 i | | | | | | | | | > Installing []db^Model.CK.ActorProfileTable (= 5.0.0 =).
                   +07.5245529 i | | | | | | | | | < 
                   +07.5245698 i | | | | | | | | | > Installing []db^Model.CK.DB.Actor.Package (= 5.0.0 =).
                   +07.5246100 i | | | | | | | | | < 
                   +07.5246256 i | | | | | | | | | > Installing []db^Model.CK.DB.Acl.Package.Head (= 1.0.0 =).
                   +07.5246537 i | | | | | | | | | < 
                   +07.5246716 i | | | | | | | | | > Installing []db^Model.CK.AclTable.Head (= 3.0.0 =).
                   +07.5247135 i | | | | | | | | | < 
                   +07.5247256 i | | | | | | | | | > Installing []db^Model.CK.AclTable (= 3.0.0 =).
                   +07.5247666 i | | | | | | | | | < 
                   +07.5247814 i | | | | | | | | | > Installing []db^Model.CK.AclConfigMemoryTable.Head (= 1.0.1 =).
                   +07.5248211 i | | | | | | | | | < 
                   +07.5248331 i | | | | | | | | | > Installing []db^Model.CK.AclConfigMemoryTable (= 1.0.1 =).
                   +07.5248679 i | | | | | | | | | < 
                   +07.5248813 i | | | | | | | | | > Installing []db^Model.CK.AclConfigTable.Head (= 1.0.0 =).
                   +07.5249179 i | | | | | | | | | < 
                   +07.5249376 i | | | | | | | | | > Installing []db^Model.CK.AclConfigTable (= 1.0.0 =).
                   +07.5249710 i | | | | | | | | | < 
                   +07.5249933 i | | | | | | | | | > Installing []db^Model.CK.DB.Acl.Package (= 1.0.0 =).
                   +07.5250380 i | | | | | | | | | < 
                   +07.5250585 i | | | | | | | | | > Installing []db^Model.CK.DB.Acl.AclType.Package.Head (= 1.0.0 =).
                   +07.5251129 i | | | | | | | | | < 
                   +07.5251419 i | | | | | | | | | > Installing []db^Model.CK.AclTypeTable.Head (= 1.0.0 =).
                   +07.5251839 i | | | | | | | | | < 
                   +07.5251995 i | | | | | | | | | > Installing []db^Model.CK.AclTypeTable (= 1.0.0 =).
                   +07.5252375 i | | | | | | | | | < 
                   +07.5252602 i | | | | | | | | | > Installing []db^Model.CK.AclTypeGrantLevelTable.Head (= 1.0.0 =).
                   +07.5252946 i | | | | | | | | | < 
                   +07.5253133 i | | | | | | | | | > Installing []db^Model.CK.AclTypeGrantLevelTable (= 1.0.0 =).
                   +07.5253432 i | | | | | | | | | < 
                   +07.5253611 i | | | | | | | | | > Installing []db^Model.CK.DB.Acl.AclType.Package (= 1.0.0 =).
                   +07.5253865 i | | | | | | | | | < 
                   +07.5254052 i | | | | | | | | | > Installing []db^Model.SqlDatabase (unversioned).
                   +07.5254454 i | | | | | | | | | < 
                   +07.5254597 i | | | | | | | | | > Installing []db^SqlDatabase.Head (unversioned).
                   +07.5255012 i | | | | | | | | | < 
                   +07.5255213 i | | | | | | | | | > Installing []db^CK.DB.Actor.Package.Head (= 5.0.0 =).
                   +07.5255525 i | | | | | | | | | < 
                   +07.5255650 i | | | | | | | | | > Installing []db^CK.ActorTable.Head (= 5.0.0 =).
                   +07.5256185 i | | | | | | | | | < 
                   +07.5256368 i | | | | | | | | | > Installing []db^CK.sActorCreate (unversioned).
                   +07.5364195   | | | | | | | | | | if OBJECT_ID('CK.sActorCreate') is not null drop Procedure CK.sActorCreate;
                   +07.5364757   | | | | | | | | | | GO
                   +07.5693905   | | | | | | | | | | -- SetupConfig: {}
                                 | | | | | | | | | |   create procedure CK.sActorCreate 
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@ActorIdResult int output
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as
                                 | | | | | | | | | |   begin
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   --<PreCreate revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	insert into CK.tActor default values;
                                 | | | | | | | | | |   	set @ActorIdResult = SCOPE_IDENTITY();
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	-- The actor is in its own group.
                                 | | | | | | | | | |   	insert into CK.tActorProfile( ActorId, GroupId ) values( @ActorIdResult, @ActorIdResult );
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	--<PostCreate />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.5695405   | | | | | | | | | | GO
                   +07.5731657 i | | | | | | | | | < 
                   +07.5732189 i | | | | | | | | | > Installing []db^CK.ActorTable (= 5.0.0 =).
                   +07.5732689 i | | | | | | | | | < 
                   +07.5732934 i | | | | | | | | | > Installing []db^CK.GroupTable.Head (= 5.0.1 =).
                   +07.5733363 i | | | | | | | | | < 
                   +07.5733586 i | | | | | | | | | > Installing []db^CK.UserTable.Head (= 5.0.3 =).
                   +07.5733947 i | | | | | | | | | < 
                   +07.5734135 i | | | | | | | | | > Installing []db^CK.sGroupCreate (unversioned).
                   +07.5737767   | | | | | | | | | | if OBJECT_ID('CK.sGroupCreate') is not null drop Procedure CK.sGroupCreate;
                   +07.5738044   | | | | | | | | | | GO
                   +07.5796618   | | | | | | | | | | -- SetupConfig: { "Requires": [ "CK.sActorCreate" ] }
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   -- Creates a Group.
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   create procedure CK.sGroupCreate 
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@GroupIdResult int output
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   --<PreCreate revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	exec CK.sActorCreate @ActorId, @GroupIdResult output;
                                 | | | | | | | | | |   	insert into CK.tGroup( GroupId ) values( @GroupIdResult );
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	--<PostCreate />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.5798184   | | | | | | | | | | GO
                   +07.5819229 i | | | | | | | | | < 
                   +07.5819648 i | | | | | | | | | > Installing []db^CK.sGroupUserAdd (unversioned).
                   +07.5823464   | | | | | | | | | | if OBJECT_ID('CK.sGroupUserAdd') is not null drop Procedure CK.sGroupUserAdd;
                   +07.5823745   | | | | | | | | | | GO
                   +07.6117483   | | | | | | | | | | -- SetupConfig: {}
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   -- Add a User to a Group. Does nothing if the User is already in the Group.
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   create procedure CK.sGroupUserAdd 
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@GroupId int,
                                 | | | | | | | | | |   	@UserId int
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |       if @GroupId <= 0 throw 50000, 'Group.InvalidId', 1;
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	-- System is, somehow, already in all groups.
                                 | | | | | | | | | |       if @UserId = 1 return 0;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   if @GroupId <> @UserId and not exists (select * from CK.tActorProfile where GroupId = @GroupId and ActorId = @UserId)
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		-- If this is the System Group, only members of it can add new Users.
                                 | | | | | | | | | |   		if @GroupId = 1 
                                 | | | | | | | | | |   		begin
                                 | | | | | | | | | |   			if not exists( select 1 from CK.tActorProfile p where p.GroupId = 1 and p.ActorId = @ActorId ) 
                                 | | | | | | | | | |   			begin
                                 | | | | | | | | | |   				;throw 50000, 'Security.ActorMustBeSytem', 1;
                                 | | | | | | | | | |   			end
                                 | | | | | | | | | |   		end
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		--<PreUserAdd revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		insert into CK.tActorProfile( ActorId, GroupId ) values( @UserId, @GroupId );
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		--<PostUserAdd />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.6119339   | | | | | | | | | | GO
                   +07.6145534 i | | | | | | | | | < 
                   +07.6145878 i | | | | | | | | | > Installing []db^CK.sGroupUserRemove (unversioned).
                   +07.6148823   | | | | | | | | | | if OBJECT_ID('CK.sGroupUserRemove') is not null drop Procedure CK.sGroupUserRemove;
                   +07.6149166   | | | | | | | | | | GO
                   +07.6180100   | | | | | | | | | | -- SetupConfig: {}
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   -- Removes a User from a Group.
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   create procedure CK.sGroupUserRemove
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@GroupId int,
                                 | | | | | | | | | |   	@UserId int
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |       if @GroupId <= 0 throw 50000, 'Group.InvalidId', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   if @GroupId <> @UserId and exists (select * from CK.tActorProfile where GroupId = @GroupId and ActorId = @UserId)
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		-- If this is the System Group, only members of it can remove Users.
                                 | | | | | | | | | |   		if @GroupId = 1 
                                 | | | | | | | | | |   		begin
                                 | | | | | | | | | |   			if not exists( select 1 from CK.tActorProfile p where p.GroupId = 1 and p.ActorId = @ActorId ) 
                                 | | | | | | | | | |   			begin
                                 | | | | | | | | | |   				;throw 50000, 'Security.ActorMustBeSytem', 1;
                                 | | | | | | | | | |   			end
                                 | | | | | | | | | |   		end
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		--<PreUserRemove revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		delete from CK.tActorProfile where GroupId = @GroupId and ActorId = @UserId;
                                 | | | | | | | | | |   		
                                 | | | | | | | | | |   		--<PostUserRemove />
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.6181363   | | | | | | | | | | GO
                   +07.6207326 i | | | | | | | | | < 
                   +07.6207749 i | | | | | | | | | > Installing []db^CK.sUserCreate (unversioned).
                   +07.6210611   | | | | | | | | | | if OBJECT_ID('CK.sUserCreate') is not null drop Procedure CK.sUserCreate;
                   +07.6210959   | | | | | | | | | | GO
                   +07.6253276   | | | | | | | | | | -- SetupConfig: { "Requires": [ "CK.sActorCreate" ] }
                                 | | | | | | | | | |   create procedure CK.sUserCreate 
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@UserName nvarchar( 255 ),
                                 | | | | | | | | | |   	@UserIdResult int output
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as
                                 | | | | | | | | | |   begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   set @UserIdResult = 0;
                                 | | | | | | | | | |   	if exists( select UserId from CK.tUser where UserName = @UserName )
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		set @UserIdResult = -1;
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   	if @UserIdResult = 0
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		--<PreCreate revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		exec CK.sActorCreate @ActorId, @UserIdResult output;
                                 | | | | | | | | | |   		insert into CK.tUser( UserId, UserName ) values ( @UserIdResult, @UserName );
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		--<PostCreate />
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.6254990   | | | | | | | | | | GO
                   +07.6297284 i | | | | | | | | | < 
                   +07.6297699 i | | | | | | | | | > Installing []db^CK.sUserUserNameSet (unversioned).
                   +07.6300480   | | | | | | | | | | if OBJECT_ID('CK.sUserUserNameSet') is not null drop Procedure CK.sUserUserNameSet;
                   +07.6300975   | | | | | | | | | | GO
                   +07.6330021   | | | | | | | | | | -- SetupConfig: {}
                                 | | | | | | | | | |   -- Sets the user name. 
                                 | | | | | | | | | |   -- There is no guaranty that the actual value will be the same as the one requested (if auto numbering 
                                 | | | | | | | | | |   -- is injected for example). 
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   create procedure CK.sUserUserNameSet
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |       @ActorId int,
                                 | | | | | | | | | |       @UserId int,
                                 | | | | | | | | | |       @UserName nvarchar(127),
                                 | | | | | | | | | |   	@Done bit output
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   set @Done = 1;
                                 | | | | | | | | | |   	if exists( select * from CK.tUser where UserName = @UserName and UserId <> @UserId )
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		set @Done = 0;
                                 | | | | | | | | | |   		--<UserNameSetClash />
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   	if @Done = 1
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		--<PreUserNameSet revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		update u 
                                 | | | | | | | | | |   			set u.UserName = @UserName
                                 | | | | | | | | | |   			from CK.tUser u   
                                 | | | | | | | | | |   			where u.UserId = @UserId;
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		--<PostUserNameSet />
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.6331329   | | | | | | | | | | GO
                   +07.6350103 i | | | | | | | | | < 
                   +07.6350451 i | | | | | | | | | > Installing []db^CK.vGroup (unversioned).
                   +07.6355743   | | | | | | | | | | if OBJECT_ID('CK.vGroup') is not null drop View CK.vGroup;
                   +07.6356252   | | | | | | | | | | GO
                   +07.6385392   | | | | | | | | | | -- SetupConfig: {}
                                 | | | | | | | | | |   create view CK.vGroup
                                 | | | | | | | | | |   as 
                                 | | | | | | | | | |   	select  g.GroupId,
                                 | | | | | | | | | |   			GroupName = N'#Group-' +  cast(g.GroupId as varchar),
                                 | | | | | | | | | |   			UserCount = (select count(*) 
                                 | | | | | | | | | |   							from CK.tUser u with(nolock) 
                                 | | | | | | | | | |   							inner join CK.tActorProfile p with(nolock) on p.ActorId = u.UserId
                                 | | | | | | | | | |   							where p.GroupId = g.GroupId)
                                 | | | | | | | | | |   		from CK.tGroup g;
                   +07.6385892   | | | | | | | | | | GO
                   +07.6398230 i | | | | | | | | | < 
                   +07.6398476 i | | | | | | | | | > Installing []db^CK.vUser (unversioned).
                   +07.6400386   | | | | | | | | | | if OBJECT_ID('CK.vUser') is not null drop View CK.vUser;
                   +07.6400693   | | | | | | | | | | GO
                   +07.6415362   | | | | | | | | | | -- SetupConfig: {}
                                 | | | | | | | | | |   create view CK.vUser
                                 | | | | | | | | | |   as 
                                 | | | | | | | | | |   	select  u.UserId,
                                 | | | | | | | | | |   			u.CreationDate,
                                 | | | | | | | | | |   			u.UserName
                                 | | | | | | | | | |   		from CK.tUser u;
                   +07.6415652   | | | | | | | | | | GO
                   +07.6424483 i | | | | | | | | | < 
                   +07.6424671 i | | | | | | | | | > Installing []db^CK.sGroupRemoveAllUsers (unversioned).
                   +07.6426469   | | | | | | | | | | if OBJECT_ID('CK.sGroupRemoveAllUsers') is not null drop Procedure CK.sGroupRemoveAllUsers;
                   +07.6426933   | | | | | | | | | | GO
                   +07.6472272   | | | | | | | | | | -- SetupConfig: { "Requires": [ "CK.sGroupUserRemove" ] }
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   -- Clears a Group.
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   create procedure CK.sGroupRemoveAllUsers
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@GroupId int
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |       if @GroupId <= 0 throw 50000, 'Group.InvalidGroup', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   declare @UserId int;
                                 | | | | | | | | | |   	declare @CUser cursor;
                                 | | | | | | | | | |   	set @CUser = cursor local fast_forward for 
                                 | | | | | | | | | |   		select ActorId from CK.tActorProfile p 
                                 | | | | | | | | | |   						inner join CK.tUser u on u.UserId = p.ActorId
                                 | | | | | | | | | |   						where p.GroupId = @GroupId and p.ActorId <> @GroupId;
                                 | | | | | | | | | |   	open @CUser;
                                 | | | | | | | | | |   	fetch from @CUser into @UserId;
                                 | | | | | | | | | |   	while @@FETCH_STATUS = 0
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		exec CK.sGroupUserRemove @ActorId, @GroupId, @UserId;
                                 | | | | | | | | | |   		fetch next from @CUser into @UserId;
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   	deallocate @CUser;
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.6473811   | | | | | | | | | | GO
                   +07.6505210 i | | | | | | | | | < 
                   +07.6505598 i | | | | | | | | | > Installing []db^CK.sUserRemoveFromAllGroups (unversioned).
                   +07.6508083   | | | | | | | | | | if OBJECT_ID('CK.sUserRemoveFromAllGroups') is not null drop Procedure CK.sUserRemoveFromAllGroups;
                   +07.6508378   | | | | | | | | | | GO
                   +07.6527656   | | | | | | | | | | -- SetupConfig: { "Requires": [ "CK.sGroupUserRemove" ] }
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   -- Removes a User from all the Groups it belongs to.
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   create procedure CK.sUserRemoveFromAllGroups
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@UserId int
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   declare @GroupId int;
                                 | | | | | | | | | |   	declare @CGroup cursor;
                                 | | | | | | | | | |   	set @CGroup = cursor local fast_forward for 
                                 | | | | | | | | | |   		select GroupId from CK.tActorProfile where ActorId = @UserId and GroupId <> @UserId;
                                 | | | | | | | | | |   	open @CGroup
                                 | | | | | | | | | |   	fetch from @CGroup into @GroupId
                                 | | | | | | | | | |   	while @@FETCH_STATUS = 0
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		exec CK.sGroupUserRemove @ActorId, @GroupId, @UserId;
                                 | | | | | | | | | |   		fetch next from @CGroup into @GroupId;
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   	deallocate @CGroup;
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.6528504   | | | | | | | | | | GO
                   +07.6544265 i | | | | | | | | | < 
                   +07.6544501 i | | | | | | | | | > Installing []db^CK.sGroupDestroy (unversioned).
                   +07.6546273   | | | | | | | | | | if OBJECT_ID('CK.sGroupDestroy') is not null drop Procedure CK.sGroupDestroy;
                   +07.6546558   | | | | | | | | | | GO
                   +07.6614946   | | | | | | | | | | -- This will be transformed by []db^CK.DB.Acl.Package([]db^CK.sGroupDestroy)
                                 | | | | | | | | | |   -- SetupConfig: { "Requires": [ "CK.sGroupRemoveAllUsers" ] }
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   -- Destroys a Group: can work only if there is no Users inside the Group except if @ForceDestroy = 1.
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   create procedure CK.sGroupDestroy
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@GroupId int,
                                 | | | | | | | | | |   	@ForceDestroy bit = 0
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |       if @GroupId <= 1 throw 50000, 'Group.Undestroyable', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   --<PreDestroy revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	if @ForceDestroy = 1
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		exec CK.sGroupRemoveAllUsers @ActorId, @GroupId;
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   	else
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		if exists( select * from CK.tActorProfile where GroupId = @GroupId and ActorId <> @GroupId ) throw 50000, 'Group.NotEmptyGroup', 1;
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   	delete from CK.tActorProfile where GroupId = @GroupId;
                                 | | | | | | | | | |   	delete from CK.tGroup where GroupId = @GroupId;
                                 | | | | | | | | | |   	delete from CK.tActor where ActorId = @GroupId;
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	--<PostDestroy />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.6616861   | | | | | | | | | | GO
                   +07.6638146 i | | | | | | | | | < 
                   +07.6638570 i | | | | | | | | | > Installing []db^CK.sUserDestroy (unversioned).
                   +07.6641319   | | | | | | | | | | if OBJECT_ID('CK.sUserDestroy') is not null drop Procedure CK.sUserDestroy;
                   +07.6641703   | | | | | | | | | | GO
                   +07.6668946   | | | | | | | | | | -- This will be transformed by []db^CK.DB.Acl.Package([]db^CK.sUserDestroy)
                                 | | | | | | | | | |   -- SetupConfig: { "Requires": [ "CK.sUserRemoveFromAllGroups" ] }
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   -- Destroys a User: automatically removes it from any Groups it may belong to.
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   create procedure CK.sUserDestroy
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@UserId int
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |       if @UserId <= 1 throw 50000, 'User.Undestroyable', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   if exists( select * from CK.tUser where UserId = @UserId )
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		--<PreDestroy revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		exec CK.sUserRemoveFromAllGroups @ActorId, @UserId;
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		delete from CK.tActorProfile where ActorId = @UserId;
                                 | | | | | | | | | |   		delete from CK.tUser where UserId = @UserId;
                                 | | | | | | | | | |   		delete from CK.tActor where ActorId = @UserId;
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		--<PostDestroy />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.6671330   | | | | | | | | | | GO
                   +07.6692981 i | | | | | | | | | < 
                   +07.6693329 i | | | | | | | | | > Installing []db^CK.GroupTable (= 5.0.1 =).
                   +07.6693735 i | | | | | | | | | < 
                   +07.6693869 i | | | | | | | | | > Installing []db^CK.UserTable (= 5.0.3 =).
                   +07.6694114 i | | | | | | | | | < 
                   +07.6694226 i | | | | | | | | | > Installing []db^CK.ActorProfileTable.Head (= 5.0.0 =).
                   +07.6694578 i | | | | | | | | | < 
                   +07.6694793 i | | | | | | | | | > Installing []db^CK.ActorProfileTable (= 5.0.0 =).
                   +07.6695069 i | | | | | | | | | < 
                   +07.6695368 i | | | | | | | | | > Installing []db^CK.DB.Actor.Package (= 5.0.0 =).
                   +07.6695939 i | | | | | | | | | < 
                   +07.6696203 i | | | | | | | | | > Installing []db^CK.DB.Acl.Package.Head (= 1.0.0 =).
                   +07.6696752 i | | | | | | | | | < 
                   +07.6697060 i | | | | | | | | | > Installing []db^CK.AclTable.Head (= 3.0.0 =).
                   +07.6697653 i | | | | | | | | | < 
                   +07.6697872 i | | | | | | | | | > Installing []db^CK.DB.Acl.Package([]db^CK.sGroupDestroy) (unversioned).
                   +07.7421417   | | | | | | | | | | Successfully applied 'inject "
                                 | | | | | | | | | |   	delete from CK.tAclConfig where ActorId = @GroupId;
                                 | | | | | | | | | |   	delete from CK.tAclConfigMemory where ActorId = @GroupId;" into "PreDestroy";'.
                   +07.7427513   | | | | | | | | | | > Parsing transformation result.
                   +07.7453615   | | | | | | | | | | < 
                   +07.7480068   | | | | | | | | | | -- SetupConfig: { "Requires": [ "CK.sGroupRemoveAllUsers" ] }
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   -- Destroys a Group: can work only if there is no Users inside the Group except if @ForceDestroy = 1.
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   alter procedure CK.sGroupDestroy
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@GroupId int,
                                 | | | | | | | | | |   	@ForceDestroy bit = 0
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |       if @GroupId <= 1 throw 50000, 'Group.Undestroyable', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   --<PreDestroy revert >
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	delete from CK.tAclConfig where ActorId = @GroupId;
                                 | | | | | | | | | |   	delete from CK.tAclConfigMemory where ActorId = @GroupId;
                                 | | | | | | | | | |   --</PreDestroy>
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	if @ForceDestroy = 1
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		exec CK.sGroupRemoveAllUsers @ActorId, @GroupId;
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   	else
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		if exists( select * from CK.tActorProfile where GroupId = @GroupId and ActorId <> @GroupId ) throw 50000, 'Group.NotEmptyGroup', 1;
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   	delete from CK.tActorProfile where GroupId = @GroupId;
                                 | | | | | | | | | |   	delete from CK.tGroup where GroupId = @GroupId;
                                 | | | | | | | | | |   	delete from CK.tActor where ActorId = @GroupId;
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	--<PostDestroy />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                                 | | | | | | | | | |   -- This has been transformed by []db^CK.DB.Acl.Package([]db^CK.sGroupDestroy)
                   +07.7482032   | | | | | | | | | | GO
                   +07.7523813 i | | | | | | | | | < 
                   +07.7524152 i | | | | | | | | | > Installing []db^CK.DB.Acl.Package([]db^CK.sUserDestroy) (unversioned).
                   +07.7578903   | | | | | | | | | | Successfully applied 'inject "
                                 | | | | | | | | | |   		delete from CK.tAclConfig where ActorId = @UserId;
                                 | | | | | | | | | |   		delete from CK.tAclConfigMemory where ActorId = @UserId;" into "PreDestroy";'.
                   +07.7579313   | | | | | | | | | | > Parsing transformation result.
                   +07.7586078   | | | | | | | | | | < 
                   +07.7594325   | | | | | | | | | | -- SetupConfig: { "Requires": [ "CK.sUserRemoveFromAllGroups" ] }
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   -- Destroys a User: automatically removes it from any Groups it may belong to.
                                 | | | | | | | | | |   --
                                 | | | | | | | | | |   alter procedure CK.sUserDestroy
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@UserId int
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |       if @UserId <= 1 throw 50000, 'User.Undestroyable', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   if exists( select * from CK.tUser where UserId = @UserId )
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		--<PreDestroy revert >
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		delete from CK.tAclConfig where ActorId = @UserId;
                                 | | | | | | | | | |   		delete from CK.tAclConfigMemory where ActorId = @UserId;
                                 | | | | | | | | | |   --</PreDestroy>
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		exec CK.sUserRemoveFromAllGroups @ActorId, @UserId;
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		delete from CK.tActorProfile where ActorId = @UserId;
                                 | | | | | | | | | |   		delete from CK.tUser where UserId = @UserId;
                                 | | | | | | | | | |   		delete from CK.tActor where ActorId = @UserId;
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   		--<PostDestroy />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                                 | | | | | | | | | |   -- This has been transformed by []db^CK.DB.Acl.Package([]db^CK.sUserDestroy)
                   +07.7595481   | | | | | | | | | | GO
                   +07.7620836 i | | | | | | | | | < 
                   +07.7621082 i | | | | | | | | | > Installing []db^CK.fAclGrantLevel (unversioned).
                   +07.7627290   | | | | | | | | | | if OBJECT_ID('CK.fAclGrantLevel') is not null drop Function CK.fAclGrantLevel;
                   +07.7627771   | | | | | | | | | | GO
                   +07.7667754   | | | | | | | | | | -- SetupConfig: {}
                                 | | | | | | | | | |   create function CK.fAclGrantLevel
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |       @ActorId int,
                                 | | | | | | | | | |       @AclId int
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   returns tinyint -- with SCHEMABINDING
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |   	return IsNull( -- Is the actor the system or a member of the system group?
                                 | | | | | | | | | |   			(select 127 from CK.tActorProfile with(nolock) 
                                 | | | | | | | | | |   					where ActorId = @ActorId and GroupId = 1), 
                                 | | | | | | | | | |   			IsNull( -- Is there any GrantLevel associated to the groups it belongs to (plus the anonymous)?
                                 | | | | | | | | | |   				(select case when max(t.GrantLevel) > 127 then 255-max(t.GrantLevel) else max(t.GrantLevel) end
                                 | | | | | | | | | |   						from 
                                 | | | | | | | | | |   						(	select c.GrantLevel
                                 | | | | | | | | | |   								from CK.tAclConfig c with(nolock)
                                 | | | | | | | | | |   								inner join CK.tActorProfile groups with(nolock) on groups.GroupId = c.ActorId
                                 | | | | | | | | | |   								where groups.ActorId = @ActorId and c.AclId = @AclId
                                 | | | | | | | | | |   							union all
                                 | | | | | | | | | |   							select c.GrantLevel 
                                 | | | | | | | | | |   								from CK.tAclConfig c with(nolock) where c.ActorId = 0 and c.AclId = @AclId
                                 | | | | | | | | | |   						) as t
                                 | | | | | | | | | |   				),
                                 | | | | | | | | | |   				-- Else, GrantLevel is zero: denied
                                 | | | | | | | | | |   				0 ));
                                 | | | | | | | | | |   end
                   +07.7669089   | | | | | | | | | | GO
                   +07.7684382 i | | | | | | | | | < 
                   +07.7684658 i | | | | | | | | | > Installing []db^CK.sAclCreate (unversioned).
                   +07.7686568   | | | | | | | | | | if OBJECT_ID('CK.sAclCreate') is not null drop Procedure CK.sAclCreate;
                   +07.7686992   | | | | | | | | | | GO
                   +07.7703829   | | | | | | | | | | -- This will be transformed by []db^CK.AclTypeTable([]db^CK.sAclCreate)
                                 | | | | | | | | | |   -- SetupConfig: {}
                                 | | | | | | | | | |   create Procedure CK.sAclCreate
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |       @ActorId int,
                                 | | | | | | | | | |       @AclIdResult int output
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   --<PreCreate revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	insert into CK.tAcl default values;
                                 | | | | | | | | | |   	set @AclIdResult = scope_identity();
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	--<PostCreate />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.7704873   | | | | | | | | | | GO
                   +07.7721229 i | | | | | | | | | < 
                   +07.7721626 i | | | | | | | | | > Installing []db^CK.sAclDestroy (unversioned).
                   +07.7723688   | | | | | | | | | | if OBJECT_ID('CK.sAclDestroy') is not null drop Procedure CK.sAclDestroy;
                   +07.7724013   | | | | | | | | | | GO
                   +07.7739641   | | | | | | | | | | -- SetupConfig: {}
                                 | | | | | | | | | |   create Procedure CK.sAclDestroy
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |       @ActorId int,
                                 | | | | | | | | | |       @AclId int
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   --<PreDestroy revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	delete from CK.tAclConfigMemory where AclId = @AclId;
                                 | | | | | | | | | |   	delete from CK.tAclConfig where AclId = @AclId;
                                 | | | | | | | | | |   	delete from CK.tAcl where AclId = @AclId;
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	--<PostDestroy />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.7740426   | | | | | | | | | | GO
                   +07.7759173 i | | | | | | | | | < 
                   +07.7759383 i | | | | | | | | | > Installing []db^CK.sAclGrantSet (unversioned).
                   +07.7761418   | | | | | | | | | | if OBJECT_ID('CK.sAclGrantSet') is not null drop Procedure CK.sAclGrantSet;
                   +07.7761672   | | | | | | | | | | GO
                   +07.7798305   | | | | | | | | | | -- This will be transformed by []db^CK.AclTypeTable([]db^CK.sAclGrantSet)
                                 | | | | | | | | | |   -- SetupConfig: {}
                                 | | | | | | | | | |   create Procedure CK.sAclGrantSet
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |       @ActorId int,
                                 | | | | | | | | | |       @AclId int,
                                 | | | | | | | | | |       @ActorIdToGrant int,
                                 | | | | | | | | | |   	@KeyReason varchar(128), -- A Key reason is optionnal. 
                                 | | | | | | | | | |       @GrantLevel tinyint
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |   	
                                 | | | | | | | | | |   	-- System is never granted since it has by design full control on all ACL.
                                 | | | | | | | | | |   	if @ActorIdToGrant = 1 return 0;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   if @KeyReason is null set @KeyReason = '';
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	--<PreMemoryUpdate revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	-- First, update CK.tAclConfigMemory with the new configuration given.
                                 | | | | | | | | | |   	merge CK.tAclConfigMemory as target
                                 | | | | | | | | | |   		using
                                 | | | | | | | | | |   		(
                                 | | | | | | | | | |   			select AclId = @AclId, ActorId = @ActorIdToGrant, KeyReason = @KeyReason
                                 | | | | | | | | | |   		) 
                                 | | | | | | | | | |   		as source on 
                                 | | | | | | | | | |   				source.AclId = target.AclId and 
                                 | | | | | | | | | |   				source.ActorId = target.ActorId and
                                 | | | | | | | | | |   				source.KeyReason = target.KeyReason
                                 | | | | | | | | | |   		when matched and @GrantLevel = 0 then delete -- When @GrantLevel = 0, we remove the entry.
                                 | | | | | | | | | |   		when matched and target.GrantLevel <> @GrantLevel then update set GrantLevel = @GrantLevel
                                 | | | | | | | | | |   		when not matched by target then insert( AclId, ActorId, KeyReason, GrantLevel ) values( @AclId, @ActorIdToGrant, @KeyReason, @GrantLevel );
                                 | | | | | | | | | |   	
                                 | | | | | | | | | |   	if @@ROWCOUNT > 0
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		--<PreConfigUpdate revert />
                                 | | | | | | | | | |   		-- The memory drives the content of the AclConfig.
                                 | | | | | | | | | |   		merge CK.tAclConfig as target
                                 | | | | | | | | | |   			using
                                 | | | | | | | | | |   			(
                                 | | | | | | | | | |   				select AclId, ActorId, MaxGrantLevel = max(GrantLevel)
                                 | | | | | | | | | |   				from CK.tAclConfigMemory m
                                 | | | | | | | | | |   				where AclId = @AclId and ActorId = @ActorIdToGrant
                                 | | | | | | | | | |   				group by AclId, ActorId
                                 | | | | | | | | | |   			) 
                                 | | | | | | | | | |   			as source on 
                                 | | | | | | | | | |   				source.AclId = target.AclId and source.ActorId = target.ActorId 
                                 | | | | | | | | | |   			when not matched by target then insert( AclId, ActorId, GrantLevel ) values( @AclId, @ActorIdToGrant, source.MaxGrantLevel )
                                 | | | | | | | | | |   			when not matched by source and target.AclId = @AclId and target.ActorId = @ActorIdToGrant then delete 
                                 | | | | | | | | | |   			when matched and target.GrantLevel <> source.MaxGrantLevel then update set GrantLevel = source.MaxGrantLevel;		
                                 | | | | | | | | | |   		--<PostConfigUpdate />
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	--<PostMemoryUpdate />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.7801478   | | | | | | | | | | GO
                   +07.7827431 i | | | | | | | | | < 
                   +07.7827752 i | | | | | | | | | > Installing []db^CK.sGroupDestroy#transform (unversioned).
                   +07.7828024 i | | | | | | | | | < 
                   +07.7828127 i | | | | | | | | | > Installing []db^CK.sUserDestroy#transform (unversioned).
                   +07.7828323 i | | | | | | | | | < 
                   +07.7828408 i | | | | | | | | | > Installing []db^CK.vAclActor (unversioned).
                   +07.7830336   | | | | | | | | | | if OBJECT_ID('CK.vAclActor') is not null drop View CK.vAclActor;
                   +07.7830644   | | | | | | | | | | GO
                   +07.7895225   | | | | | | | | | | -- SetupConfig: {}
                                 | | | | | | | | | |   -- Kernel view for Acl that evaluates for each Actor and each Acl the resulting GrantLevel.
                                 | | | | | | | | | |   create view CK.vAclActor -- with SCHEMABINDING
                                 | | | | | | | | | |   as
                                 | | | | | | | | | |   	select 	
                                 | | | | | | | | | |   		acl.AclId,
                                 | | | | | | | | | |   		ActorId = a.ActorId, 
                                 | | | | | | | | | |   		GrantLevel = CAST(
                                 | | | | | | | | | |   		IsNull( -- Is the actor the system or a member of the system group?
                                 | | | | | | | | | |   			(select 127 from CK.tActorProfile with(nolock) 
                                 | | | | | | | | | |   					where ActorId = a.ActorId and GroupId = 1), 
                                 | | | | | | | | | |   			IsNull( -- Is there any GrantLevel associated to the groups it belongs to (plus the anonymous)?
                                 | | | | | | | | | |   				(select case when max(t.GrantLevel) > 127 then 255-max(t.GrantLevel) else max(t.GrantLevel) end
                                 | | | | | | | | | |   						from 
                                 | | | | | | | | | |   						(	select c.GrantLevel
                                 | | | | | | | | | |   								from CK.tAclConfig c with(nolock)
                                 | | | | | | | | | |   								inner join CK.tActorProfile groups with(nolock) on groups.GroupId = c.ActorId
                                 | | | | | | | | | |   								where groups.ActorId = a.ActorId and c.AclId = acl.AclId
                                 | | | | | | | | | |   							union all
                                 | | | | | | | | | |   							select c.GrantLevel 
                                 | | | | | | | | | |   								from CK.tAclConfig c with(nolock) where c.ActorId = 0 and c.AclId = acl.AclId
                                 | | | | | | | | | |   						) as t
                                 | | | | | | | | | |   				),
                                 | | | | | | | | | |   				-- Else, GrantLevel is zero: denied
                                 | | | | | | | | | |   				0 ) 
                                 | | | | | | | | | |   		) as tinyint)
                                 | | | | | | | | | |   		from CK.tAcl acl with(nolock)
                                 | | | | | | | | | |   		cross join CK.tActor a with(nolock);
                   +07.7896310   | | | | | | | | | | GO
                   +07.7912941 i | | | | | | | | | < 
                   +07.7913209 i | | | | | | | | | > Installing []db^CK.vAclActorReason (unversioned).
                   +07.7915458   | | | | | | | | | | if OBJECT_ID('CK.vAclActorReason') is not null drop View CK.vAclActorReason;
                   +07.7915761   | | | | | | | | | | GO
                   +07.7956361   | | | | | | | | | | -- SetupConfig: {}
                                 | | | | | | | | | |   -- Kernel Acl view that gives for each Actor and each Acl the ActorId (GroupId or UserId) that
                                 | | | | | | | | | |   -- is responsible for the actual GrantLevel.
                                 | | | | | | | | | |   -- The ReasonId (that is the ActorId) is positive for a Grant and negative for a Deny.
                                 | | | | | | | | | |   create view CK.vAclActorReason -- with SCHEMABINDING
                                 | | | | | | | | | |   as
                                 | | | | | | | | | |   	select 	acl.AclId,
                                 | | | | | | | | | |   		ActorId = a.ActorId, 
                                 | | | | | | | | | |   		ReasonId = IsNull( 
                                 | | | | | | | | | |   						-- Is the actor the system or a member of the system group? 
                                 | | | | | | | | | |   						-- If yes, ReasonId is group 1 (system).
                                 | | | | | | | | | |   						(select 1 from CK.tActorProfile with(nolock) 
                                 | | | | | | | | | |   								where ActorId = a.ActorId and GroupId = 1),
                                 | | | | | | | | | |   						IsNull( -- Is there any GrantLevel associated to the groups it belongs to (plus anonymous)? 
                                 | | | | | | | | | |   								-- If yes, Reason is the best group identifier (one of those that decide):
                                 | | | | | | | | | |   								--  positive if the GrantLevel is the result of a normal grant level.
                                 | | | | | | | | | |   								--  negative (i.e. -GroupId) if the group is restricting the level (deny, ie > 127).
                                 | | | | | | | | | |   								-- Note: it works because Anonymous can not deny: when ActorId = 0 it is a necessarily a grant. 
                                 | | | | | | | | | |   							(select top (1) case when t.GrantLevel <= 127 then abs(t.ActorId) else -abs(t.ActorId) end
                                 | | | | | | | | | |   									from 
                                 | | | | | | | | | |   									(	select c.GrantLevel, c.ActorId
                                 | | | | | | | | | |   											from CK.tAclConfig c with(nolock)
                                 | | | | | | | | | |   											inner join CK.tActorProfile groups with(nolock) on groups.GroupId = c.ActorId
                                 | | | | | | | | | |   											where groups.ActorId = a.ActorId and c.AclId = acl.AclId
                                 | | | | | | | | | |   										union all
                                 | | | | | | | | | |   										select c.GrantLevel, 0
                                 | | | | | | | | | |   											from CK.tAclConfig c with(nolock) where c.ActorId = 0 and c.AclId = acl.AclId
                                 | | | | | | | | | |   									) as t
                                 | | | | | | | | | |    								order by t.GrantLevel desc, t.ActorId desc ),
                                 | | | | | | | | | |   							-- Else, GrantLevel is zero: denied. Reason is -1: no rights.
                                 | | | | | | | | | |   							-1 )
                                 | | | | | | | | | |   				)
                                 | | | | | | | | | |   		from CK.tAcl acl with(nolock)
                                 | | | | | | | | | |   		cross join CK.tActor a with(nolock);
                   +07.7957829   | | | | | | | | | | GO
                   +07.7975983 i | | | | | | | | | < 
                   +07.7976277 i | | | | | | | | | > Installing []db^CK.AclTable (= 3.0.0 =).
                   +07.7976572 i | | | | | | | | | < 
                   +07.7976723 i | | | | | | | | | > Installing []db^CK.AclConfigMemoryTable.Head (= 1.0.1 =).
                   +07.7977192 i | | | | | | | | | < 
                   +07.7977299 i | | | | | | | | | > Installing []db^CK.vAclConfigMemory (unversioned).
                   +07.7979177   | | | | | | | | | | if OBJECT_ID('CK.vAclConfigMemory') is not null drop View CK.vAclConfigMemory;
                   +07.7979619   | | | | | | | | | | GO
                   +07.8002677   | | | | | | | | | | -- SetupConfig: { "Requires": [ "CK.vAclActor" ] }
                                 | | | | | | | | | |   -- This view gives, along with the resulting level, the configuration reason for each Actor and each Acl.
                                 | | | | | | | | | |   -- This is the most detailed view, based on the tAclConfigMemory table.
                                 | | | | | | | | | |   -- Each (ActorId,AclId) appear multiple times, once by actual configuration with its KeyReason string.
                                 | | | | | | | | | |   create view CK.vAclConfigMemory --with SCHEMABINDING
                                 | | | | | | | | | |   as 
                                 | | | | | | | | | |   select 	ac.AclId, 
                                 | | | | | | | | | |   		ac.ActorId, 
                                 | | | | | | | | | |   		ac.GrantLevel,
                                 | | | | | | | | | |   		ResultingLevel = acl.GrantLevel,
                                 | | | | | | | | | |   		KeyReason = ac.KeyReason
                                 | | | | | | | | | |   	from CK.tAclConfigMemory ac
                                 | | | | | | | | | |   	inner join CK.vAclActor acl on acl.AclId = ac.AclId and acl.ActorId = ac.ActorId;
                   +07.8003377   | | | | | | | | | | GO
                   +07.8024646 i | | | | | | | | | < 
                   +07.8024914 i | | | | | | | | | > Installing []db^CK.AclConfigMemoryTable (= 1.0.1 =).
                   +07.8025315 i | | | | | | | | | < 
                   +07.8025659 i | | | | | | | | | > Installing []db^CK.AclConfigTable.Head (= 1.0.0 =).
                   +07.8025877 i | | | | | | | | | < 
                   +07.8025980 i | | | | | | | | | > Installing []db^CK.vAclConfig (unversioned).
                   +07.8027805   | | | | | | | | | | if OBJECT_ID('CK.vAclConfig') is not null drop View CK.vAclConfig;
                   +07.8028252   | | | | | | | | | | GO
                   +07.8046645   | | | | | | | | | | -- SetupConfig: { "Requires": [ "CK.vAclActor" ] }
                                 | | | | | | | | | |   -- This view gives, along with the resulting level, the configuration for each Actor and each Acl.
                                 | | | | | | | | | |   -- This view is based on the tAclConfig table: each (ActorId,AclId) appear multiple times, once by configuration.
                                 | | | | | | | | | |   -- The vAclConfigMemory view gives more information. 
                                 | | | | | | | | | |   create view CK.vAclConfig --with SCHEMABINDING
                                 | | | | | | | | | |   as 
                                 | | | | | | | | | |   select 	ac.AclId, 
                                 | | | | | | | | | |   		ac.ActorId, 
                                 | | | | | | | | | |   		ac.GrantLevel,
                                 | | | | | | | | | |   		ResultingLevel = acl.GrantLevel
                                 | | | | | | | | | |   	from CK.tAclConfig ac
                                 | | | | | | | | | |   	inner join CK.vAclActor acl on acl.AclId = ac.AclId and acl.ActorId = ac.ActorId;
                   +07.8047310   | | | | | | | | | | GO
                   +07.8059940 i | | | | | | | | | < 
                   +07.8060176 i | | | | | | | | | > Installing []db^CK.AclConfigTable (= 1.0.0 =).
                   +07.8060479 i | | | | | | | | | < 
                   +07.8060613 i | | | | | | | | | > Installing []db^CK.DB.Acl.Package (= 1.0.0 =).
                   +07.8060863 i | | | | | | | | | < 
                   +07.8061002 i | | | | | | | | | > Installing []db^CK.DB.Acl.AclType.Package.Head (= 1.0.0 =).
                   +07.8061265 i | | | | | | | | | < 
                   +07.8061408 i | | | | | | | | | > Installing []db^CK.AclTypeTable.Head (= 1.0.0 =).
                   +07.8061666 i | | | | | | | | | < 
                   +07.8061787 i | | | | | | | | | > Installing []db^CK.AclTypeTable([]db^CK.sAclCreate) (unversioned).
                   +07.8161586   | | | | | | | | | | Successfully applied 'add parameter @AclTypeId int=0;'.
                   +07.8567670   | | | | | | | | | | Successfully applied 'add column AclTypeId=@AclTypeId;'.
                   +07.8578068   | | | | | | | | | | -- SetupConfig: {}
                                 | | | | | | | | | |   alter Procedure CK.sAclCreate
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |       @ActorId int,
                                 | | | | | | | | | |       @AclIdResult int output
                                 | | | | | | | | | |   ,
                                 | | | | | | | | | |   @AclTypeId int = 0)
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   --<PreCreate revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	insert into CK.tAcl (AclTypeId )values(@AclTypeId);
                                 | | | | | | | | | |   	set @AclIdResult = scope_identity();
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	--<PostCreate />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   -- This has been transformed by []db^CK.AclTypeTable([]db^CK.sAclCreate)
                   +07.8579764   | | | | | | | | | | GO
                   +07.8606543 i | | | | | | | | | < 
                   +07.8606954 i | | | | | | | | | > Installing []db^CK.AclTypeTable([]db^CK.sAclGrantSet) (unversioned).
                   +07.8659017   | | | | | | | | | | Successfully applied 'inject "
                                 | | | | | | | | | |     		if exists( select *
                                 | | | | | | | | | |   					from CK.tAcl a
                                 | | | | | | | | | |   					inner join CK.tAclType t on t.AclTypeId = a.AclTypeId
                                 | | | | | | | | | |   					where a.AclId = @AclId 
                                 | | | | | | | | | |   							and t.ConstrainedGrantLevel = 1
                                 | | | | | | | | | |   							and (case when @GrantLevel >= 127 then 255 - @GrantLevel else @GrantLevel end) 
                                 | | | | | | | | | |   									not in (select l.GrantLevel from CK.tAclTypeGrantLevel l where l.AclTypeId = t.AclTypeId) )
                                 | | | | | | | | | |   		begin
                                 | | | | | | | | | |   			;throw 50000, 'Security.AclTypeConstrainedLevelError', 1;
                                 | | | | | | | | | |   		end
                                 | | | | | | | | | |     " into "PreMemoryUpdate";'.
                   +07.8659807   | | | | | | | | | | > Parsing transformation result.
                   +07.8680624   | | | | | | | | | | < 
                   +07.8702969   | | | | | | | | | | -- SetupConfig: {}
                                 | | | | | | | | | |   ALTER Procedure CK.sAclGrantSet
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |       @ActorId int,
                                 | | | | | | | | | |       @AclId int,
                                 | | | | | | | | | |       @ActorIdToGrant int,
                                 | | | | | | | | | |   	@KeyReason varchar(128), -- A Key reason is optionnal. 
                                 | | | | | | | | | |       @GrantLevel tinyint
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as begin
                                 | | | | | | | | | |   	
                                 | | | | | | | | | |   	-- System is never granted since it has by design full control on all ACL.
                                 | | | | | | | | | |   	if @ActorIdToGrant = 1 return 0;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   if @KeyReason is null set @KeyReason = '';
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	--<PreMemoryUpdate revert >
                                 | | | | | | | | | |   
                                 | | | | | | | | | |     		if exists( select *
                                 | | | | | | | | | |   					from CK.tAcl a
                                 | | | | | | | | | |   					inner join CK.tAclType t on t.AclTypeId = a.AclTypeId
                                 | | | | | | | | | |   					where a.AclId = @AclId 
                                 | | | | | | | | | |   							and t.ConstrainedGrantLevel = 1
                                 | | | | | | | | | |   							and (case when @GrantLevel >= 127 then 255 - @GrantLevel else @GrantLevel end) 
                                 | | | | | | | | | |   									not in (select l.GrantLevel from CK.tAclTypeGrantLevel l where l.AclTypeId = t.AclTypeId) )
                                 | | | | | | | | | |   		begin
                                 | | | | | | | | | |   			;throw 50000, 'Security.AclTypeConstrainedLevelError', 1;
                                 | | | | | | | | | |   		end
                                 | | | | | | | | | |   --</PreMemoryUpdate>
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	-- First, update CK.tAclConfigMemory with the new configuration given.
                                 | | | | | | | | | |   	merge CK.tAclConfigMemory as target
                                 | | | | | | | | | |   		using
                                 | | | | | | | | | |   		(
                                 | | | | | | | | | |   			select AclId = @AclId, ActorId = @ActorIdToGrant, KeyReason = @KeyReason
                                 | | | | | | | | | |   		) 
                                 | | | | | | | | | |   		as source on 
                                 | | | | | | | | | |   				source.AclId = target.AclId and 
                                 | | | | | | | | | |   				source.ActorId = target.ActorId and
                                 | | | | | | | | | |   				source.KeyReason = target.KeyReason
                                 | | | | | | | | | |   		when matched and @GrantLevel = 0 then delete -- When @GrantLevel = 0, we remove the entry.
                                 | | | | | | | | | |   		when matched and target.GrantLevel <> @GrantLevel then update set GrantLevel = @GrantLevel
                                 | | | | | | | | | |   		when not matched by target then insert( AclId, ActorId, KeyReason, GrantLevel ) values( @AclId, @ActorIdToGrant, @KeyReason, @GrantLevel );
                                 | | | | | | | | | |   	
                                 | | | | | | | | | |   	if @@ROWCOUNT > 0
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		--<PreConfigUpdate revert />
                                 | | | | | | | | | |   		-- The memory drives the content of the AclConfig.
                                 | | | | | | | | | |   		merge CK.tAclConfig as target
                                 | | | | | | | | | |   			using
                                 | | | | | | | | | |   			(
                                 | | | | | | | | | |   				select AclId, ActorId, MaxGrantLevel = max(GrantLevel)
                                 | | | | | | | | | |   				from CK.tAclConfigMemory m
                                 | | | | | | | | | |   				where AclId = @AclId and ActorId = @ActorIdToGrant
                                 | | | | | | | | | |   				group by AclId, ActorId
                                 | | | | | | | | | |   			) 
                                 | | | | | | | | | |   			as source on 
                                 | | | | | | | | | |   				source.AclId = target.AclId and source.ActorId = target.ActorId 
                                 | | | | | | | | | |   			when not matched by target then insert( AclId, ActorId, GrantLevel ) values( @AclId, @ActorIdToGrant, source.MaxGrantLevel )
                                 | | | | | | | | | |   			when not matched by source and target.AclId = @AclId and target.ActorId = @ActorIdToGrant then delete 
                                 | | | | | | | | | |   			when matched and target.GrantLevel <> source.MaxGrantLevel then update set GrantLevel = source.MaxGrantLevel;		
                                 | | | | | | | | | |   		--<PostConfigUpdate />
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	--<PostMemoryUpdate />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   -- This has been transformed by []db^CK.AclTypeTable([]db^CK.sAclGrantSet)
                   +07.8705958   | | | | | | | | | | GO
                   +07.8740480 i | | | | | | | | | < 
                   +07.8740775 i | | | | | | | | | > Installing []db^CK.sAclTypeConstrainedGrantLevelSet (unversioned).
                   +07.8743376   | | | | | | | | | | if OBJECT_ID('CK.sAclTypeConstrainedGrantLevelSet') is not null drop Procedure CK.sAclTypeConstrainedGrantLevelSet;
                   +07.8743939   | | | | | | | | | | GO
                   +07.8774015   | | | | | | | | | | -- SetupConfig: { }
                                 | | | | | | | | | |   create procedure CK.sAclTypeConstrainedGrantLevelSet 
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@AclTypeId int,
                                 | | | | | | | | | |   	@Set bit
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as
                                 | | | | | | | | | |   begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   --<PreAclTypeConstrainedGrantLevel revert />
                                 | | | | | | | | | |   	update CK.tAclType set ConstrainedGrantLevel = @Set 
                                 | | | | | | | | | |   		where AclTypeId = @AclTypeId;
                                 | | | | | | | | | |   	if @@RowCount > 0 and @Set = 1
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		-- Check that defined levels actually match all existing configurations.
                                 | | | | | | | | | |   		if exists( select *
                                 | | | | | | | | | |   					from CK.tAclType t
                                 | | | | | | | | | |   					inner join CK.tAcl a on a.AclTypeId = t.AclTypeId
                                 | | | | | | | | | |   					inner join CK.tAclConfigMemory m on m.AclId = a.AclId
                                 | | | | | | | | | |   					where t.AclTypeId = @AclTypeId 
                                 | | | | | | | | | |   							and (case when m.GrantLevel >= 127 then 255 - m.GrantLevel else m.GrantLevel end) 
                                 | | | | | | | | | |   									not in (select l.GrantLevel from CK.tAclTypeGrantLevel l where l.AclTypeId = @AclTypeId) )
                                 | | | | | | | | | |   		begin
                                 | | | | | | | | | |   			;throw 50000, 'Security.AclTypeConstrainedLevelMismatch', 1;
                                 | | | | | | | | | |   		end
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   	--<PostAclTypeConstrainedGrantLevel />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.8776108   | | | | | | | | | | GO
                   +07.8802722 i | | | | | | | | | < 
                   +07.8803222 i | | | | | | | | | > Installing []db^CK.sAclTypeCreate (unversioned).
                   +07.8805881   | | | | | | | | | | if OBJECT_ID('CK.sAclTypeCreate') is not null drop Procedure CK.sAclTypeCreate;
                   +07.8806216   | | | | | | | | | | GO
                   +07.8828716   | | | | | | | | | | -- SetupConfig: { }
                                 | | | | | | | | | |   create procedure CK.sAclTypeCreate 
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@AclTypeIdResult int output
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as
                                 | | | | | | | | | |   begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   --<PreAclTypeCreate revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	insert into CK.tAclType( ConstrainedGrantLevel ) values ( 0 );
                                 | | | | | | | | | |   	set @AclTypeIdResult = SCOPE_IDENTITY();
                                 | | | | | | | | | |   	insert into CK.tAclTypeGrantLevel( AclTypeId, GrantLevel ) 
                                 | | | | | | | | | |   		 values ( @AclTypeIdResult, 0 ),	-- Blind
                                 | | | | | | | | | |   				( @AclTypeIdResult, 127 );	-- Administrator
                                 | | | | | | | | | |   	--<PostAclTypeCreate />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.8830323   | | | | | | | | | | GO
                   +07.8850998 i | | | | | | | | | < 
                   +07.8851252 i | | | | | | | | | > Installing []db^CK.sAclTypeDestroy (unversioned).
                   +07.8853501   | | | | | | | | | | if OBJECT_ID('CK.sAclTypeDestroy') is not null drop Procedure CK.sAclTypeDestroy;
                   +07.8853916   | | | | | | | | | | GO
                   +07.8872796   | | | | | | | | | | -- SetupConfig: { }
                                 | | | | | | | | | |   create procedure CK.sAclTypeDestroy
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@AclTypeId int
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as
                                 | | | | | | | | | |   begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   --<PreAclTypeDestroy revert />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   	delete from CK.tAclTypeGrantLevel where AclTypeId = @AclTypeId;
                                 | | | | | | | | | |   	delete from CK.tAclType where AclTypeId = @AclTypeId;
                                 | | | | | | | | | |   			
                                 | | | | | | | | | |   	--<PostAclTypeDestroy />
                                 | | | | | | | | | |   
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.8873653   | | | | | | | | | | GO
                   +07.8895555 i | | | | | | | | | < 
                   +07.8895796 i | | | | | | | | | > Installing []db^CK.sAclTypeGrantLevelSet (unversioned).
                   +07.8898156   | | | | | | | | | | if OBJECT_ID('CK.sAclTypeGrantLevelSet') is not null drop Procedure CK.sAclTypeGrantLevelSet;
                   +07.8898482   | | | | | | | | | | GO
                   +07.8932719   | | | | | | | | | | -- SetupConfig: { }
                                 | | | | | | | | | |   create procedure CK.sAclTypeGrantLevelSet 
                                 | | | | | | | | | |   (
                                 | | | | | | | | | |   	@ActorId int,
                                 | | | | | | | | | |   	@AclTypeId int,
                                 | | | | | | | | | |   	@GrantLevel tinyint,
                                 | | | | | | | | | |   	@Set bit
                                 | | | | | | | | | |   )
                                 | | | | | | | | | |   as
                                 | | | | | | | | | |   begin
                                 | | | | | | | | | |       if @ActorId <= 0 throw 50000, 'Security.AnonymousNotAllowed', 1;
                                 | | | | | | | | | |       if @GrantLevel > 127 throw 50000, 'Security.GrantLevelMustBeAtMost127', 1;
                                 | | | | | | | | | |   	if @Set = 0 and (@GrantLevel = 0 or @GrantLevel = 127) throw 50000, 'Security.GrantLevel0And127CanNotBeRemoved', 1;
                                 | | | | | | | | | |   --[=beginsp]
                                 | | | | | | | | | |   set nocount on; declare @SPCallTC int = @@TRANCOUNT, @SPCallId sysname; 
                                 | | | | | | | | | |   beginsp: if @SPCallTC = 0 begin tran; else begin set @SPCallId = cast(32*cast(@@PROCID as bigint)+@@NESTLEVEL as varchar); save transaction @SPCallId; end begin try
                                 | | | | | | | | | |   --[=/beginsp]
                                 | | | | | | | | | |   if @Set = 0
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		declare @GrantLevelDeny tinyint = 255 - @GrantLevel;
                                 | | | | | | | | | |   		--<PreRemoveLevel revert />
                                 | | | | | | | | | |   		-- When removing a level, we must ensure that, if the AclType is constrained, the 
                                 | | | | | | | | | |   		-- removed level does not appear in any Acl current configuration.
                                 | | | | | | | | | |   		if exists( select *
                                 | | | | | | | | | |   					from CK.tAcl a
                                 | | | | | | | | | |   					inner join CK.tAclType t on t.AclTypeId = a.AclTypeId
                                 | | | | | | | | | |   					inner join CK.tAclConfigMemory m on m.AclId = a.AclId
                                 | | | | | | | | | |   					where a.AclTypeId = @AclTypeId 
                                 | | | | | | | | | |   							and t.ConstrainedGrantLevel = 1
                                 | | | | | | | | | |   							and (m.GrantLevel = @GrantLevel or m.GrantLevel = @GrantLevelDeny))
                                 | | | | | | | | | |   		begin
                                 | | | | | | | | | |   			;throw 50000, 'Security.AclTypeConstrainedLevelIsUsed', 1;
                                 | | | | | | | | | |   		end
                                 | | | | | | | | | |   		delete l from CK.tAclTypeGrantLevel l where l.AclTypeId = @AclTypeId and l.GrantLevel = @GrantLevel;
                                 | | | | | | | | | |   		--<PostRemoveLevel />
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   	else 
                                 | | | | | | | | | |   	begin
                                 | | | | | | | | | |   		--<PreAddLevel revert />
                                 | | | | | | | | | |   		-- One can always add a level.
                                 | | | | | | | | | |   		merge CK.tAclTypeGrantLevel as target
                                 | | | | | | | | | |   			using ( select AclTypeId = @AclTypeId, GrantLevel = @GrantLevel ) 
                                 | | | | | | | | | |   			as source on source.AclTypeId = target.AclTypeId and source.GrantLevel = target.GrantLevel
                                 | | | | | | | | | |   			when not matched by target then insert ( AclTypeId, GrantLevel ) values( source.AclTypeId, source.GrantLevel );
                                 | | | | | | | | | |   		--<PostAddLevel />
                                 | | | | | | | | | |   	end
                                 | | | | | | | | | |   --[=endsp]
                                 | | | | | | | | | |   end try
                                 | | | | | | | | | |   begin catch if @SPCallTC = 0 rollback; else if XACT_STATE() = 1 rollback transaction @SPCallId; exec CKCore.sErrorRethrow @@ProcId; return -1; end catch;
                                 | | | | | | | | | |   endsp: if @SPCallTC = 0 commit; return 0;
                                 | | | | | | | | | |   --[=/endsp]
                                 | | | | | | | | | |   end
                   +07.8934923   | | | | | | | | | | GO
                   +07.8959431 i | | | | | | | | | < 
                   +07.8959726 i | | | | | | | | | > Installing []db^CK.AclTypeTable (= 1.0.0 =).
                   +07.8960003 i | | | | | | | | | < 
                   +07.8960252 i | | | | | | | | | > Installing []db^CK.sAclCreate#transform (unversioned).
                   +07.8960627 i | | | | | | | | | < 
                   +07.8960833 i | | | | | | | | | > Installing []db^CK.sAclGrantSet#transform (unversioned).
                   +07.8961176 i | | | | | | | | | < 
                   +07.8961315 i | | | | | | | | | > Installing []db^CK.AclTypeGrantLevelTable.Head (= 1.0.0 =).
                   +07.8961716 i | | | | | | | | | < 
                   +07.8961841 i | | | | | | | | | > Installing []db^CK.AclTypeGrantLevelTable (= 1.0.0 =).
                   +07.8962225 i | | | | | | | | | < 
                   +07.8962533 i | | | | | | | | | > Installing []db^CK.DB.Acl.AclType.Package (= 1.0.0 =).
                   +07.8962908 i | | | | | | | | | < 
                   +07.8963033 i | | | | | | | | | > Installing []db^SqlDatabase (unversioned).
                   +07.8963635 i | | | | | | | | | < 
                   +07.8963836 i | | | | | | | | < 
                   +07.8964037 i | | | | | | | | > Settle step.
                   +07.8976004   | | | | | | | | | > Raising Settle setup event.
                   +07.8976402   | | | | | | | | | < 
                   +07.8976709 i | | | | | | | | | > Settling []CK._g.poco.Factory.
                   +07.8996072 i | | | | | | | | | < 
                   +07.8996340 i | | | | | | | | | > Settling []db^SqlDatabase.Connection.
                   +07.8999071 i | | | | | | | | | < 
                   +07.8999321 i | | | | | | | | | > Settling []db^Model.SqlDatabase.Head.
                   +07.9001788 i | | | | | | | | | < 
                   +07.9002034 i | | | | | | | | | > Settling []db^Model.CK.DB.Actor.Package.Head.
                   +07.9002306 i | | | | | | | | | < 
                   +07.9002471 i | | | | | | | | | > Settling []db^Model.CK.ActorTable.Head.
                   +07.9002975 i | | | | | | | | | < 
                   +07.9003078 i | | | | | | | | | > Settling []db^Model.CK.ActorTable.
                   +07.9013878 i | | | | | | | | | < 
                   +07.9014137 i | | | | | | | | | > Settling []db^Model.CK.GroupTable.Head.
                   +07.9014391 i | | | | | | | | | < 
                   +07.9014467 i | | | | | | | | | > Settling []db^Model.CK.UserTable.Head.
                   +07.9014672 i | | | | | | | | | < 
                   +07.9014744 i | | | | | | | | | > Settling []db^Model.CK.GroupTable.
                   +07.9015047 i | | | | | | | | | < 
                   +07.9015145 i | | | | | | | | | > Settling []db^Model.CK.UserTable.
                   +07.9015444 i | | | | | | | | | < 
                   +07.9015547 i | | | | | | | | | > Settling []db^Model.CK.ActorProfileTable.Head.
                   +07.9015873 i | | | | | | | | | < 
                   +07.9015971 i | | | | | | | | | > Settling []db^Model.CK.ActorProfileTable.
                   +07.9016328 i | | | | | | | | | < 
                   +07.9016422 i | | | | | | | | | > Settling []db^Model.CK.DB.Actor.Package.
                   +07.9016680 i | | | | | | | | | < 
                   +07.9016756 i | | | | | | | | | > Settling []db^Model.CK.DB.Acl.Package.Head.
                   +07.9016939 i | | | | | | | | | < 
                   +07.9017011 i | | | | | | | | | > Settling []db^Model.CK.AclTable.Head.
                   +07.9017189 i | | | | | | | | | < 
                   +07.9017261 i | | | | | | | | | > Settling []db^Model.CK.AclTable.
                   +07.9017466 i | | | | | | | | | < 
                   +07.9017546 i | | | | | | | | | > Settling []db^Model.CK.AclConfigMemoryTable.Head.
                   +07.9017729 i | | | | | | | | | < 
                   +07.9017801 i | | | | | | | | | > Settling []db^Model.CK.AclConfigMemoryTable.
                   +07.9018006 i | | | | | | | | | < 
                   +07.9018082 i | | | | | | | | | > Settling []db^Model.CK.AclConfigTable.Head.
                   +07.9018269 i | | | | | | | | | < 
                   +07.9018340 i | | | | | | | | | > Settling []db^Model.CK.AclConfigTable.
                   +07.9018541 i | | | | | | | | | < 
                   +07.9018613 i | | | | | | | | | > Settling []db^Model.CK.DB.Acl.Package.
                   +07.9018818 i | | | | | | | | | < 
                   +07.9018894 i | | | | | | | | | > Settling []db^Model.CK.DB.Acl.AclType.Package.Head.
                   +07.9019081 i | | | | | | | | | < 
                   +07.9019157 i | | | | | | | | | > Settling []db^Model.CK.AclTypeTable.Head.
                   +07.9019349 i | | | | | | | | | < 
                   +07.9019425 i | | | | | | | | | > Settling []db^Model.CK.AclTypeTable.
                   +07.9019702 i | | | | | | | | | < 
                   +07.9019777 i | | | | | | | | | > Settling []db^Model.CK.AclTypeGrantLevelTable.Head.
                   +07.9019969 i | | | | | | | | | < 
                   +07.9020041 i | | | | | | | | | > Settling []db^Model.CK.AclTypeGrantLevelTable.
                   +07.9020304 i | | | | | | | | | < 
                   +07.9020657 i | | | | | | | | | > Settling []db^Model.CK.DB.Acl.AclType.Package.
                   +07.9021036 i | | | | | | | | | < 
                   +07.9021116 i | | | | | | | | | > Settling []db^Model.SqlDatabase.
                   +07.9021393 i | | | | | | | | | < 
                   +07.9021504 i | | | | | | | | | > Settling []db^SqlDatabase.Head.
                   +07.9021830 i | | | | | | | | | < 
                   +07.9021933 i | | | | | | | | | > Settling []db^CK.DB.Actor.Package.Head.
                   +07.9022259 i | | | | | | | | | < 
                   +07.9022383 i | | | | | | | | | > Settling []db^CK.ActorTable.Head.
                   +07.9022767 i | | | | | | | | | < 
                   +07.9022879 i | | | | | | | | | > Settling []db^CK.sActorCreate.
                   +07.9023156 i | | | | | | | | | < 
                   +07.9023227 i | | | | | | | | | > Settling []db^CK.ActorTable.
                   +07.9023454 i | | | | | | | | | < 
                   +07.9023530 i | | | | | | | | | > Settling []db^CK.GroupTable.Head.
                   +07.9023727 i | | | | | | | | | < 
                   +07.9023901 i | | | | | | | | | > Settling []db^CK.UserTable.Head.
                   +07.9024463 i | | | | | | | | | < 
                   +07.9024713 i | | | | | | | | | > Settling []db^CK.sGroupCreate.
                   +07.9025944 i | | | | | | | | | < 
                   +07.9026113 i | | | | | | | | | > Settling []db^CK.sGroupUserAdd.
                   +07.9026439 i | | | | | | | | | < 
                   +07.9026595 i | | | | | | | | | > Settling []db^CK.sGroupUserRemove.
                   +07.9027006 i | | | | | | | | | < 
                   +07.9027126 i | | | | | | | | | > Settling []db^CK.sUserCreate.
                   +07.9027528 i | | | | | | | | | < 
                   +07.9027729 i | | | | | | | | | > Settling []db^CK.sUserUserNameSet.
                   +07.9028215 i | | | | | | | | | < 
                   +07.9028340 i | | | | | | | | | > Settling []db^CK.vGroup.
                   +07.9029059 i | | | | | | | | | < 
                   +07.9029228 i | | | | | | | | | > Settling []db^CK.vUser.
                   +07.9030349 i | | | | | | | | | < 
                   +07.9030509 i | | | | | | | | | > Settling []db^CK.sGroupRemoveAllUsers.
                   +07.9031634 i | | | | | | | | | < 
                   +07.9031750 i | | | | | | | | | > Settling []db^CK.sUserRemoveFromAllGroups.
                   +07.9033093 i | | | | | | | | | < 
                   +07.9033236 i | | | | | | | | | > Settling []db^CK.sGroupDestroy.
                   +07.9033865 i | | | | | | | | | < 
                   +07.9033995 i | | | | | | | | | > Settling []db^CK.sUserDestroy.
                   +07.9035275 i | | | | | | | | | < 
                   +07.9035476 i | | | | | | | | | > Settling []db^CK.GroupTable.
                   +07.9036109 i | | | | | | | | | < 
                   +07.9036194 i | | | | | | | | | > Settling []db^CK.UserTable.
                   +07.9037310 i | | | | | | | | | < 
                   +07.9037435 i | | | | | | | | | > Settling []db^CK.ActorProfileTable.Head.
                   +07.9038457 i | | | | | | | | | < 
                   +07.9038608 i | | | | | | | | | > Settling []db^CK.ActorProfileTable.
                   +07.9039844 i | | | | | | | | | < 
                   +07.9040041 i | | | | | | | | | > Settling []db^CK.DB.Actor.Package.
                   +07.9044561 i | | | | | | | | | < 
                   +07.9044767 i | | | | | | | | | > Settling []db^CK.DB.Acl.Package.Head.
                   +07.9045034 i | | | | | | | | | < 
                   +07.9045186 i | | | | | | | | | > Settling []db^CK.AclTable.Head.
                   +07.9046200 i | | | | | | | | | < 
                   +07.9046329 i | | | | | | | | | > Settling []db^CK.DB.Acl.Package([]db^CK.sGroupDestroy).
                   +07.9046887 i | | | | | | | | | < 
                   +07.9047052 i | | | | | | | | | > Settling []db^CK.DB.Acl.Package([]db^CK.sUserDestroy).
                   +07.9047855 i | | | | | | | | | < 
                   +07.9048203 i | | | | | | | | | > Settling []db^CK.fAclGrantLevel.
                   +07.9048922 i | | | | | | | | | < 
                   +07.9049100 i | | | | | | | | | > Settling []db^CK.sAclCreate.
                   +07.9049957 i | | | | | | | | | < 
                   +07.9050845 i | | | | | | | | | > Settling []db^CK.sAclDestroy.
                   +07.9051264 i | | | | | | | | | < 
                   +07.9051367 i | | | | | | | | | > Settling []db^CK.sAclGrantSet.
                   +07.9051630 i | | | | | | | | | < 
                   +07.9051701 i | | | | | | | | | > Settling []db^CK.sGroupDestroy#transform.
                   +07.9051880 i | | | | | | | | | < 
                   +07.9052036 i | | | | | | | | | > Settling []db^CK.sUserDestroy#transform.
                   +07.9052224 i | | | | | | | | | < 
                   +07.9052290 i | | | | | | | | | > Settling []db^CK.vAclActor.
                   +07.9052469 i | | | | | | | | | < 
                   +07.9052536 i | | | | | | | | | > Settling []db^CK.vAclActorReason.
                   +07.9055075 i | | | | | | | | | < 
                   +07.9055308 i | | | | | | | | | > Settling []db^CK.AclTable.
                   +07.9056343 i | | | | | | | | | < 
                   +07.9056557 i | | | | | | | | | > Settling []db^CK.AclConfigMemoryTable.Head.
                   +07.9057102 i | | | | | | | | | < 
                   +07.9057204 i | | | | | | | | | > Settling []db^CK.vAclConfigMemory.
                   +07.9058744 i | | | | | | | | | < 
                   +07.9058878 i | | | | | | | | | > Settling []db^CK.AclConfigMemoryTable.
                   +07.9059632 i | | | | | | | | | < 
                   +07.9059748 i | | | | | | | | | > Settling []db^CK.AclConfigTable.Head.
                   +07.9061073 i | | | | | | | | | < 
                   +07.9061229 i | | | | | | | | | > Settling []db^CK.vAclConfig.
                   +07.9062452 i | | | | | | | | | < 
                   +07.9062657 i | | | | | | | | | > Settling []db^CK.AclConfigTable.
                   +07.9063242 i | | | | | | | | | < 
                   +07.9063380 i | | | | | | | | | > Settling []db^CK.DB.Acl.Package.
                   +07.9064460 i | | | | | | | | | < 
                   +07.9064585 i | | | | | | | | | > Settling []db^CK.DB.Acl.AclType.Package.Head.
                   +07.9065692 i | | | | | | | | | < 
                   +07.9065857 i | | | | | | | | | > Settling []db^CK.AclTypeTable.Head.
                   +07.9067079 i | | | | | | | | | < 
                   +07.9067191 i | | | | | | | | | > Settling []db^CK.AclTypeTable([]db^CK.sAclCreate).
                   +07.9068106 i | | | | | | | | | < 
                   +07.9068208 i | | | | | | | | | > Settling []db^CK.AclTypeTable([]db^CK.sAclGrantSet).
                   +07.9069248 i | | | | | | | | | < 
                   +07.9069427 i | | | | | | | | | > Settling []db^CK.sAclTypeConstrainedGrantLevelSet.
                   +07.9070953 i | | | | | | | | | < 
                   +07.9071069 i | | | | | | | | | > Settling []db^CK.sAclTypeCreate.
                   +07.9072006 i | | | | | | | | | < 
                   +07.9072126 i | | | | | | | | | > Settling []db^CK.sAclTypeDestroy.
                   +07.9073255 i | | | | | | | | | < 
                   +07.9073376 i | | | | | | | | | > Settling []db^CK.sAclTypeGrantLevelSet.
                   +07.9074255 i | | | | | | | | | < 
                   +07.9074358 i | | | | | | | | | > Settling []db^CK.AclTypeTable.
                   +07.9075397 i | | | | | | | | | < 
                   +07.9075518 i | | | | | | | | | > Settling []db^CK.sAclCreate#transform.
                   +07.9076191 i | | | | | | | | | < 
                   +07.9076294 i | | | | | | | | | > Settling []db^CK.sAclGrantSet#transform.
                   +07.9077191 i | | | | | | | | | < 
                   +07.9077298 i | | | | | | | | | > Settling []db^CK.AclTypeGrantLevelTable.Head.
                   +07.9078159 i | | | | | | | | | < 
                   +07.9078289 i | | | | | | | | | > Settling []db^CK.AclTypeGrantLevelTable.
                   +07.9079226 i | | | | | | | | | < 
                   +07.9079422 i | | | | | | | | | > Settling []db^CK.DB.Acl.AclType.Package.
                   +07.9080422 i | | | | | | | | | < 
                   +07.9080556 i | | | | | | | | | > Settling []db^SqlDatabase.
                   +07.9081471 i | | | | | | | | | < 
                   +07.9081636   | | | | | | | | | > Raising Success setup event.
                   +07.9082305   | | | | | | | | | < 
                   +07.9082622 i | | | | | | | | < 
                   +07.9090088 i | | | | | | | | > Disposing 86 drivers.
                   +07.9090642 i | | | | | | | | < 
                   +07.9090753   | | | | | | | | > Raising Disposed setup event.
                   +07.9098513   | | | | | | | | < 
                   +07.9139086 i | | | | | | | < 
                   +07.9139465 i | | | | | | | > Aspect: CK.SqlServer.Setup.SqlSetupAspect.
                   +07.9141647 i | | | | | | | < 
                   +07.9142334 i | | | | | | | > Executing initial 0 deferred actions.
                   +07.9142856 i | | | | | | | <  | 1 conclusion:
                                 | | | | | | |    | Executed 0 actions.
                   +07.9143272 i | | | | | | < 
                   +07.9161394 i | | | | | | > Generating AppContext assembly (first run).
                   +07.9172309 i | | | | | | | > Generating StObj dynamic assembly.
                   +07.9512759 i | | | | | | | | > Generating source code.
                   +08.0074746 i | | | | | | | | | > Generating Method GroupTable.CreateGroupAsync( ISqlCallContext ctx, Int32 actorId ) => Task`1.
                   +08.0131214   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sGroupCreate(@ActorId int, @GroupIdResult int output)'.
                   +08.0234159   | | | | | | | | | | < 
                   +08.0758508 i | | | | | | | | | < 
                   +08.0759267 i | | | | | | | | | > Generating Method GroupTable.DestroyGroupAsync( ISqlCallContext ctx, Int32 actorId, Int32 groupId, Boolean forceDestroy = False ) => Task.
                   +08.0760994   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sGroupDestroy(@ActorId int, @GroupId int, @ForceDestroy bit=0)'.
                   +08.0761677   | | | | | | | | | | < 
                   +08.0766291 i | | | | | | | | | < 
                   +08.0766550 i | | | | | | | | | > Generating Method GroupTable.AddUserAsync( ISqlCallContext ctx, Int32 actorId, Int32 groupId, Int32 userId ) => Task.
                   +08.0767326   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sGroupUserAdd(@ActorId int, @GroupId int, @UserId int)'.
                   +08.0767996   | | | | | | | | | | < 
                   +08.0769049 i | | | | | | | | | < 
                   +08.0769267 i | | | | | | | | | > Generating Method GroupTable.RemoveUserAsync( ISqlCallContext ctx, Int32 actorId, Int32 groupId, Int32 userId ) => Task.
                   +08.0769754   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sGroupUserRemove(@ActorId int, @GroupId int, @UserId int)'.
                   +08.0770432   | | | | | | | | | | < 
                   +08.0771440 i | | | | | | | | | < 
                   +08.0771864 i | | | | | | | | | > Generating Method GroupTable.RemoveAllUsersAsync( ISqlCallContext ctx, Int32 actorId, Int32 groupId ) => Task.
                   +08.0772533   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sGroupRemoveAllUsers(@ActorId int, @GroupId int)'.
                   +08.0773154   | | | | | | | | | | < 
                   +08.0774104 i | | | | | | | | | < 
                   +08.0774287 i | | | | | | | | | > Generating Method GroupTable.CreateGroup( ISqlCallContext ctx, Int32 actorId ) => Int32.
                   +08.0782209 i | | | | | | | | | < 
                   +08.0782486 i | | | | | | | | | > Generating Method GroupTable.DestroyGroup( ISqlCallContext ctx, Int32 actorId, Int32 groupId, Boolean forceDestroy = False ).
                   +08.0783806 i | | | | | | | | | < 
                   +08.0784034 i | | | | | | | | | > Generating Method GroupTable.AddUser( ISqlCallContext ctx, Int32 actorId, Int32 groupId, Int32 userId ).
                   +08.0785172 i | | | | | | | | | < 
                   +08.0785444 i | | | | | | | | | > Generating Method GroupTable.RemoveUser( ISqlCallContext ctx, Int32 actorId, Int32 groupId, Int32 userId ).
                   +08.0786573 i | | | | | | | | | < 
                   +08.0786770 i | | | | | | | | | > Generating Method GroupTable.RemoveAllUsers( ISqlCallContext ctx, Int32 actorId, Int32 groupId ).
                   +08.0787586 i | | | | | | | | | < 
                   +08.0788322 i | | | | | | | | | > Generating Method UserTable.CreateUserAsync( ISqlCallContext ctx, Int32 actorId, String userName ) => Task`1.
                   +08.0789072   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sUserCreate(@ActorId int, @UserName nvarchar(255), @UserIdResult int output)'.
                   +08.0795528   | | | | | | | | | | < 
                   +08.0798866 i | | | | | | | | | < 
                   +08.0799161 i | | | | | | | | | > Generating Method UserTable.UserNameSetAsync( ISqlCallContext ctx, Int32 actorId, Int32 userId, String userName ) => Task`1.
                   +08.0800027   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sUserUserNameSet(@ActorId int, @UserId int, @UserName nvarchar(127), @Done bit output)'.
                   +08.0800893   | | | | | | | | | | < 
                   +08.0802932 i | | | | | | | | | < 
                   +08.0803155 i | | | | | | | | | > Generating Method UserTable.DestroyUserAsync( ISqlCallContext ctx, Int32 actorId, Int32 userId ) => Task.
                   +08.0803873   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sUserDestroy(@ActorId int, @UserId int)'.
                   +08.0804498   | | | | | | | | | | < 
                   +08.0805493 i | | | | | | | | | < 
                   +08.0805699 i | | | | | | | | | > Generating Method UserTable.RemoveFromAllGroupsAsync( ISqlCallContext ctx, Int32 actorId, Int32 userId ) => Task.
                   +08.0806145   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sUserRemoveFromAllGroups(@ActorId int, @UserId int)'.
                   +08.0806823   | | | | | | | | | | < 
                   +08.0807778 i | | | | | | | | | < 
                   +08.0807979 i | | | | | | | | | > Generating Method UserTable.CreateUser( ISqlCallContext ctx, Int32 actorId, String userName ) => Int32.
                   +08.0808898 i | | | | | | | | | < 
                   +08.0809219 i | | | | | | | | | > Generating Method UserTable.UserNameSet( ISqlCallContext ctx, Int32 actorId, Int32 userId, String userName ) => Boolean.
                   +08.0810634 i | | | | | | | | | < 
                   +08.0810987 i | | | | | | | | | > Generating Method UserTable.DestroyUser( ISqlCallContext ctx, Int32 actorId, Int32 userId ).
                   +08.0813156 i | | | | | | | | | < 
                   +08.0813553 i | | | | | | | | | > Generating Method UserTable.RemoveFromAllGroups( ISqlCallContext ctx, Int32 actorId, Int32 userId ).
                   +08.0815641 i | | | | | | | | | < 
                   +08.0817592 i | | | | | | | | | > Generating Method AclTable.CreateAclAsync( ISqlCallContext ctx, Int32 actorId ) => Task`1.
                   +08.0818618   | | | | | | | | | | > Low level SqlCommand create method for: 'Procedure CK.sAclCreate(@ActorId int, @AclIdResult int output, @AclTypeId int=0)'.
                   +08.0819586   | | | | | | | | | | < 
                   +08.0827052 i | | | | | | | | | | Parameter '@AclTypeId int=0' will use its default sql value '0'.
                   +08.0895840 i | | | | | | | | | < 
                   +08.0896470 i | | | | | | | | | > Generating Method AclTable.DestroyAclAsync( ISqlCallContext ctx, Int32 actorId, Int32 aclId ) => Task.
                   +08.0897210   | | | | | | | | | | > Low level SqlCommand create method for: 'Procedure CK.sAclDestroy(@ActorId int, @AclId int)'.
                   +08.0898192   | | | | | | | | | | < 
                   +08.0974688 i | | | | | | | | | < 
                   +08.0975795 i | | | | | | | | | > Generating Method AclTable.AclGrantSetAsync( ISqlCallContext ctx, Int32 actorId, Int32 aclId, Int32 actorIdToGrant, String keyReason, Byte grantLevel ) => Task.
                   +08.0977643   | | | | | | | | | | > Low level SqlCommand create method for: 'Procedure CK.sAclGrantSet(@ActorId int, @AclId int, @ActorIdToGrant int, @KeyReason varchar(128), @GrantLevel tinyint)'.
                   +08.0979213   | | | | | | | | | | < 
                   +08.0981155 i | | | | | | | | | < 
                   +08.0981565 i | | | | | | | | | > Generating Method AclTable.GetGrantLevelAsync( ISqlCallContext ctx, Int32 actorId, Int32 aclId ) => Task`1.
                   +08.0992610   | | | | | | | | | | > Low level SqlCommand create method for: 'function CK.fAclGrantLevel(@ActorId int, @AclId int) returns tinyint'.
                   +08.1004149   | | | | | | | | | | < 
                   +08.1011691 i | | | | | | | | | < 
                   +08.1012057 i | | | | | | | | | > Generating Method AclTable.CreateAcl( ISqlCallContext ctx, Int32 actorId ) => Int32.
                   +08.1013842 i | | | | | | | | | | Parameter '@AclTypeId int=0' will use its default sql value '0'.
                   +08.1014449 i | | | | | | | | | < 
                   +08.1014743 i | | | | | | | | | > Generating Method AclTable.DestroyAcl( ISqlCallContext ctx, Int32 actorId, Int32 aclId ).
                   +08.1016127 i | | | | | | | | | < 
                   +08.1016506 i | | | | | | | | | > Generating Method AclTable.AclGrantSet( ISqlCallContext ctx, Int32 actorId, Int32 aclId, Int32 actorIdToGrant, String keyReason, Byte grantLevel ).
                   +08.1018796 i | | | | | | | | | < 
                   +08.1019300 i | | | | | | | | | > Generating Method AclTable.GetGrantLevel( ISqlCallContext ctx, Int32 actorId, Int32 aclId ) => Byte.
                   +08.1020710 i | | | | | | | | | < 
                   +08.1021960 i | | | | | | | | | > Generating Method AclTypeTable.CreateAclTypeAsync( ISqlCallContext ctx, Int32 actorId ) => Task`1.
                   +08.1022776   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sAclTypeCreate(@ActorId int, @AclTypeIdResult int output)'.
                   +08.1023446   | | | | | | | | | | < 
                   +08.1024793 i | | | | | | | | | < 
                   +08.1025132 i | | | | | | | | | > Generating Method AclTypeTable.DestroyAclTypeAsync( ISqlCallContext ctx, Int32 actorId, Int32 aclTypeId ) => Task.
                   +08.1025779   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sAclTypeDestroy(@ActorId int, @AclTypeId int)'.
                   +08.1026685   | | | | | | | | | | < 
                   +08.1027814 i | | | | | | | | | < 
                   +08.1028314 i | | | | | | | | | > Generating Method AclTypeTable.SetConstrainedGrantLevelAsync( ISqlCallContext ctx, Int32 actorId, Int32 aclTypeId, Boolean set ) => Task.
                   +08.1029242   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sAclTypeConstrainedGrantLevelSet(@ActorId int, @AclTypeId int, @Set bit)'.
                   +08.1030050   | | | | | | | | | | < 
                   +08.1031303 i | | | | | | | | | < 
                   +08.1031754 i | | | | | | | | | > Generating Method AclTypeTable.SetGrantLevelAsync( ISqlCallContext ctx, Int32 actorId, Int32 aclTypeId, Byte grantLevel, Boolean set ) => Task.
                   +08.1032517   | | | | | | | | | | > Low level SqlCommand create method for: 'procedure CK.sAclTypeGrantLevelSet(@ActorId int, @AclTypeId int, @GrantLevel tinyint, @Set bit)'.
                   +08.1033182   | | | | | | | | | | < 
                   +08.1034088 i | | | | | | | | | < 
                   +08.1034427 i | | | | | | | | | > Generating Method AclTypeTable.CreateAclAsync( ISqlCallContext ctx, Int32 actorId, Int32 aclTypeId ) => Task`1.
                   +08.1035614 i | | | | | | | | | < 
                   +08.1035900 i | | | | | | | | | > Generating Method AclTypeTable.CreateAclType( ISqlCallContext ctx, Int32 actorId ) => Int32.
                   +08.1036962 i | | | | | | | | | < 
                   +08.1037314 i | | | | | | | | | > Generating Method AclTypeTable.DestroyAclType( ISqlCallContext ctx, Int32 actorId, Int32 aclTypeId ).
                   +08.1038296 i | | | | | | | | | < 
                   +08.1038657 i | | | | | | | | | > Generating Method AclTypeTable.SetConstrainedGrantLevel( ISqlCallContext ctx, Int32 actorId, Int32 aclTypeId, Boolean set ).
                   +08.1039679 i | | | | | | | | | < 
                   +08.1040059 i | | | | | | | | | > Generating Method AclTypeTable.SetGrantLevel( ISqlCallContext ctx, Int32 actorId, Int32 aclTypeId, Byte grantLevel, Boolean set ).
                   +08.1041322 i | | | | | | | | | < 
                   +08.1041710 i | | | | | | | | | > Generating Method AclTypeTable.CreateAcl( ISqlCallContext ctx, Int32 actorId, Int32 aclTypeId ) => Int32.
                   +08.1042759 i | | | | | | | | | < 
                   +08.1157386 i | | | | | | | | < 
                   +08.1157676 i | | | | | | | | > Compiling source code.
                   +12.9476172 i | | | | | | | | | Saved source file: C:\Dev\CK-Database-Projects\CK-DB\Tests\CK.DB.Acl.AclType.Tests\CKSetup-WorkingDir\2018-04-13 08h41.50.3146177\CK.StObj.AutoAssembly.dll.0.cs
                   +12.9509618 i | | | | | | | | | Saved source file: C:\Dev\CK-Database-Projects\CK-DB\Tests\CK.DB.Acl.AclType.Tests\CKSetup-WorkingDir\2018-04-13 08h41.50.3146177\CK.StObj.AutoAssembly.dll.1.cs
                   +12.9552253 i | | | | | | | | | > Code Generation information.
                   +12.9553016 i | | | | | | | | | | Source code generation and compilation succeeded.
                   +12.9572705 i | | | | | | | | | <  | 1 conclusion:
                                 | | | | | | | | |    | Succeeded.
                   +12.9575605 i | | | | | | | | < 
                   +12.9575806 i | | | | | | | < 
                   +12.9666483 i | | | | | | | > Copying generated files to folder: 'C:\Dev\CK-Database-Projects\CK-DB\CK.DB.Acl.AclType\bin\Debug\netstandard2.0\'.
                   +12.9667559 i | | | | | | | | CK.StObj.AutoAssembly.dll.0.cs
                   +12.9716668 i | | | | | | | | CK.StObj.AutoAssembly.dll.1.cs
                   +12.9738356 i | | | | | | | | CK.StObj.AutoAssembly.dll
                   +12.9759307 i | | | | | | | < 
                   +12.9760356 i | | | | | | | > Copying generated files to folder: 'C:\Dev\CK-Database-Projects\CK-DB\Tests\CK.DB.Acl.AclType.Tests\bin\Debug\netcoreapp2.0'.
                   +12.9760789 i | | | | | | | | CK.StObj.AutoAssembly.dll.0.cs
                   +12.9776207 i | | | | | | | | CK.StObj.AutoAssembly.dll.1.cs
                   +12.9803178 i | | | | | | | | CK.StObj.AutoAssembly.dll
                   +12.9819586 i | | | | | | | < 
                   +12.9820911 i | | | | | | < 
                   +12.9894333 i | | | | | | > Terminating Aspects.
                   +12.9897652 i | | | | | | | > Aspect: CK.SqlServer.Setup.SqlSetupAspect.
                   +12.9900134 i | | | | | | | < 
                   +12.9900433 i | | | | | | | > Aspect: CK.Setup.SetupableAspect.
                   +12.9970480 i | | | | | | | < 
                   +12.9971279 i | | | | | | | > Executing initial 0 deferred actions.
                   +12.9971797 i | | | | | | | <  | 1 conclusion:
                                 | | | | | | |    | Executed 0 actions.
                   +12.9972310 i | | | | | | < 
                   +13.0132860 i | | | | | | No assembly load conflicts.
                   +13.3348180 i | | | | | < 
                   +13.3348381   | | | | < 
                   +13.3348755 i | | | < 
                   +13.3365029   | | | > Updating signature files.
                   +13.3382095   | | | < 
                   +13.3382635   | | | Leaving Working Directory 'C:\Dev\CK-Database-Projects\CK-DB\Tests\CK.DB.Acl.AclType.Tests\CKSetup-WorkingDir\2018-04-13 08h41.50.3146177\' as-is.
                   +13.3382701 i | | <  | 1 conclusion:
                                 | |    | Succeed
                   +13.3403443 i | | > Closing Store.
                   +13.3415201 i | | < 
                   +13.3415361 i | < 
                   +13.3465030 i | > Loading StObj map from CK.StObj.AutoAssembly.
                   +13.4062215 i | | > Loading dynamic 'CK.StObj.AutoAssembly, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null'.
                   +13.5099553 i | | < 
                   +13.5099807 i | < 
                   +13.5100089 i < 
2~~~~                            ~~ Monitor: 37b6636d-a058-4414-be41-1d899bf2cf05
                   +13.8240607 E exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2051, @GrantLevel=0, @Set=0
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2051, @GrantLevel=0, @Set=0
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    Security.GrantLevel0And127CanNotBeRemoved
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader()
                                    |  |  |                at System.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(IAsyncResult asyncResult)
                                    |  |  |                at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
                                    |  |  |             --- End of stack trace from previous location where exception was thrown ---
                                    |  |  |                at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
                                    |  |  |                at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
                                    |  |  |                at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.<CK-SqlServer-ISqlCommandExecutor-ExecuteQueryAsync>d__17`1.MoveNext()
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +13.9124127 E exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2051, @GrantLevel=127, @Set=0
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2051, @GrantLevel=127, @Set=0
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    Security.GrantLevel0And127CanNotBeRemoved
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader()
                                    |  |  |                at System.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(IAsyncResult asyncResult)
                                    |  |  |                at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
                                    |  |  |             --- End of stack trace from previous location where exception was thrown ---
                                    |  |  |                at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
                                    |  |  |                at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
                                    |  |  |                at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.<CK-SqlServer-ISqlCommandExecutor-ExecuteQueryAsync>d__17`1.MoveNext()
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +13.9373383 E exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2051, @GrantLevel=128, @Set=1
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2051, @GrantLevel=128, @Set=1
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    Security.GrantLevelMustBeAtMost127
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader()
                                    |  |  |                at System.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(IAsyncResult asyncResult)
                                    |  |  |                at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
                                    |  |  |             --- End of stack trace from previous location where exception was thrown ---
                                    |  |  |                at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
                                    |  |  |                at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
                                    |  |  |                at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.<CK-SqlServer-ISqlCommandExecutor-ExecuteQueryAsync>d__17`1.MoveNext()
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +13.9567064 E exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2051, @GrantLevel=255, @Set=1
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2051, @GrantLevel=255, @Set=1
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    Security.GrantLevelMustBeAtMost127
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader()
                                    |  |  |                at System.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(IAsyncResult asyncResult)
                                    |  |  |                at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
                                    |  |  |             --- End of stack trace from previous location where exception was thrown ---
                                    |  |  |                at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
                                    |  |  |                at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
                                    |  |  |                at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.<CK-SqlServer-ISqlCommandExecutor-ExecuteQueryAsync>d__17`1.MoveNext()
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +13.9799732 E exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2051, @GrantLevel=255, @Set=0
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2051, @GrantLevel=255, @Set=0
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    Security.GrantLevelMustBeAtMost127
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader()
                                    |  |  |                at System.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(IAsyncResult asyncResult)
                                    |  |  |                at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
                                    |  |  |             --- End of stack trace from previous location where exception was thrown ---
                                    |  |  |                at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
                                    |  |  |                at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
                                    |  |  |                at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.<CK-SqlServer-ISqlCommandExecutor-ExecuteQueryAsync>d__17`1.MoveNext()
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +14.0784752 i Done.
3~~~~                            ~~ Monitor: 7fcc4414-fda0-49da-bf71-9e0ddc233bb9
                   +14.2112922 i Done.
4~~~~                            ~~ Monitor: 6b610bd9-07f1-4c03-9783-44b6b9d501c7
                   +14.3501738 E exec CK.sAclTypeConstrainedGrantLevelSet <= @ActorId=1, @AclTypeId=2053, @Set=1
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclTypeConstrainedGrantLevelSet <= @ActorId=1, @AclTypeId=2053, @Set=1
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    ck:sAclTypeConstrainedGrantLevelSet-{29}-[Security.AclTypeConstrainedLevelMismatch]
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                    |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +14.4920871 i Done.
5~~~~                            ~~ Monitor: ebae7766-1c68-42e0-a8e6-00ff803f8fe9
                   +14.5697524 E exec CK.sAclTypeDestroy <= @ActorId=1, @AclTypeId=2054
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclTypeDestroy <= @ActorId=1, @AclTypeId=2054
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    ck:sAclTypeDestroy-{17}-[The DELETE statement conflicted with the REFERENCE constraint "FK_CK_tAcl_AclTypeId". The conflict occurred in database "CKTEST_CK_DB_Acl_AclType", table "CK.tAcl", column 'AclTypeId'.]
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader()
                                    |  |  |                at System.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(IAsyncResult asyncResult)
                                    |  |  |                at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
                                    |  |  |             --- End of stack trace from previous location where exception was thrown ---
                                    |  |  |                at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
                                    |  |  |                at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
                                    |  |  |                at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.<CK-SqlServer-ISqlCommandExecutor-ExecuteQueryAsync>d__17`1.MoveNext()
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +14.6095198 i Done.
6~~~~                            ~~ Monitor: 53285e72-d908-4cc0-b864-d7e499f78a8b
                   +14.6913713 E exec CK.sAclGrantSet <= @ActorId=1, @AclId=2071, @ActorIdToGrant=2323, @KeyReason='A reason', @GrantLevel=50
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclGrantSet <= @ActorId=1, @AclId=2071, @ActorIdToGrant=2323, @KeyReason='A reason', @GrantLevel=50
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    ck:sAclGrantSet-{30}-[Security.AclTypeConstrainedLevelError]
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                    |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +14.7417847 E exec CK.sAclGrantSet <= @ActorId=1, @AclId=2071, @ActorIdToGrant=2323, @KeyReason='A reason', @GrantLevel=205
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclGrantSet <= @ActorId=1, @AclId=2071, @ActorIdToGrant=2323, @KeyReason='A reason', @GrantLevel=205
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    ck:sAclGrantSet-{30}-[Security.AclTypeConstrainedLevelError]
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                    |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +14.8546518 E exec CK.sAclGrantSet <= @ActorId=1, @AclId=2071, @ActorIdToGrant=2323, @KeyReason=null, @GrantLevel=75
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclGrantSet <= @ActorId=1, @AclId=2071, @ActorIdToGrant=2323, @KeyReason=null, @GrantLevel=75
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    ck:sAclGrantSet-{30}-[Security.AclTypeConstrainedLevelError]
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                    |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +14.9263839 E exec CK.sAclGrantSet <= @ActorId=1, @AclId=2071, @ActorIdToGrant=2323, @KeyReason=null, @GrantLevel=180
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclGrantSet <= @ActorId=1, @AclId=2071, @ActorIdToGrant=2323, @KeyReason=null, @GrantLevel=180
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    ck:sAclGrantSet-{30}-[Security.AclTypeConstrainedLevelError]
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                    |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +15.0459968 E exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2055, @GrantLevel=75, @Set=0
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2055, @GrantLevel=75, @Set=0
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    ck:sAclTypeGrantLevelSet-{32}-[Security.AclTypeConstrainedLevelIsUsed]
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                    |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +15.1008880 E exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2055, @GrantLevel=50, @Set=0
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclTypeGrantLevelSet <= @ActorId=1, @AclTypeId=2055, @GrantLevel=50, @Set=0
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    ck:sAclTypeGrantLevelSet-{32}-[Security.AclTypeConstrainedLevelIsUsed]
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                    |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +15.1815636 E exec CK.sAclGrantSet <= @ActorId=1, @AclId=2071, @ActorIdToGrant=2323, @KeyReason='Won''t do it!', @GrantLevel=50
                                    ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                    | Message:    exec CK.sAclGrantSet <= @ActorId=1, @AclId=2071, @ActorIdToGrant=2323, @KeyReason='Won''t do it!', @GrantLevel=50
                                    |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                    |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                    |  |  | Message:    ck:sAclGrantSet-{30}-[Security.AclTypeConstrainedLevelError]
                                    |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                    |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                    |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                    |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                    |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                    |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                    |  |  └─────────────────────────────────────────────────────────────────────────
                                    |  └─────────────────────────────────────────────────────────────────────────
                                    └─────────────────────────────────────────────────────────────────────────
                   +15.2961096 i Done.
7~~~~                            ~~ Monitor: a467dc3d-4355-4e52-85ce-f5789dd05970
                   +15.3786082 i Done.
8~~~~                            ~~ Monitor: 2477d083-e6d1-478f-875f-e6d39cbe1837
                   +15.4321909 i Done.
9~~~~                            ~~ Monitor: 9d70d163-724e-4a40-84a6-5fc7c3f08401
                   +15.5026078 i Done.
A~~~~                            ~~ Monitor: a40245bc-00aa-43f4-9929-a16ca0d976b5
                   +15.5665743 i Done.
B~~~~                            ~~ Monitor: 65dc74e1-53f4-459e-8faf-a74def78136c
                   +15.6339803 i Done.
C~~~~                            ~~ Monitor: 0cfda1dd-4e55-4111-b935-0a2e8a62914d
                   +15.7001048 i Done.
D~~~~                            ~~ Monitor: 770134be-f662-46d1-8634-337cc3026c77
                   +15.7591210 i Done.
E~~~~                            ~~ Monitor: 6c0d06d4-564f-4145-9e29-b0ea7c6b02be
                   +15.8113208 i Done.
F~~~~                            ~~ Monitor: 1acc27da-8091-4505-9901-af9989c4bea8
                   +16.1415103 i Done.
10~~~~                            ~~ Monitor: fd34d3ca-12cc-49e1-aa22-cef01a27d9f3
                    +16.2849244 i Done.
11~~~~                            ~~ Monitor: c33178f2-a4e0-4ef3-b562-43a482ada6ce
                    +16.7220490 i Done.
12~~~~                            ~~ Monitor: df8e9e12-17bf-483c-9a81-3e0916a3947a
                    +16.7470397 E exec CK.sGroupCreate <= @ActorId=0, @GroupIdResult=null output
                                     ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                     | Message:    exec CK.sGroupCreate <= @ActorId=0, @GroupIdResult=null output
                                     |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                     |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                     |  |  | Message:    Security.AnonymousNotAllowed
                                     |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                     |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                     |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                     |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                     |  |  └─────────────────────────────────────────────────────────────────────────
                                     |  └─────────────────────────────────────────────────────────────────────────
                                     └─────────────────────────────────────────────────────────────────────────
                    +16.7792093 i Done.
13~~~~                            ~~ Monitor: 1dd938e2-65c8-485d-8ee5-a65de223c421
                    +16.8109303 E exec CK.sGroupDestroy <= @ActorId=0, @GroupId=2338, @ForceDestroy=0
                                     ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                     | Message:    exec CK.sGroupDestroy <= @ActorId=0, @GroupId=2338, @ForceDestroy=0
                                     |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                     |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                     |  |  | Message:    Security.AnonymousNotAllowed
                                     |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                     |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                     |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                     |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                     |  |  └─────────────────────────────────────────────────────────────────────────
                                     |  └─────────────────────────────────────────────────────────────────────────
                                     └─────────────────────────────────────────────────────────────────────────
                    +16.8544885 i Done.
14~~~~                            ~~ Monitor: 11b98e04-aa10-4f9c-8a25-3aa1a20004c0
                    +16.9175463 E exec CK.sGroupDestroy <= @ActorId=1, @GroupId=2339, @ForceDestroy=0
                                     ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                     | Message:    exec CK.sGroupDestroy <= @ActorId=1, @GroupId=2339, @ForceDestroy=0
                                     |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                     |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                     |  |  | Message:    ck:sGroupDestroy-{30}-[Group.NotEmptyGroup]
                                     |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                     |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                     |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                     |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                     |  |  └─────────────────────────────────────────────────────────────────────────
                                     |  └─────────────────────────────────────────────────────────────────────────
                                     └─────────────────────────────────────────────────────────────────────────
                    +17.0108996 i Done.
15~~~~                            ~~ Monitor: 8a23c924-421c-4a2b-875b-4ac0791c83cf
                    +17.1928430 i Done.
16~~~~                            ~~ Monitor: da966215-8527-4d8d-96d3-1af1f716f290
                    +17.3235658 i Done.
17~~~~                            ~~ Monitor: c0eff19d-fc13-4ca1-b95a-7ae4480dcc18
                    +17.4243307 i Done.
18~~~~                            ~~ Monitor: c522d854-978a-4ad8-b355-4b3f88f06da5
                    +17.5410324 i Done.
19~~~~                            ~~ Monitor: bf0a5879-f320-40d0-aae5-bd5094d9c7dd
                    +17.6311445 i Done.
1A~~~~                            ~~ Monitor: eff9c387-72c3-44c2-9214-655bcb635f25
                    +17.6490751 E exec CK.sGroupUserRemove <= @ActorId=2348, @GroupId=1, @UserId=2347
                                     ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                     | Message:    exec CK.sGroupUserRemove <= @ActorId=2348, @GroupId=1, @UserId=2347
                                     |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                     |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                     |  |  | Message:    ck:sGroupUserRemove-{25}-[Security.ActorMustBeSytem]
                                     |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                     |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                     |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                     |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                     |  |  └─────────────────────────────────────────────────────────────────────────
                                     |  └─────────────────────────────────────────────────────────────────────────
                                     └─────────────────────────────────────────────────────────────────────────
                    +17.7087816 E exec CK.sGroupUserAdd <= @ActorId=2348, @GroupId=1, @UserId=2349
                                     ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                     | Message:    exec CK.sGroupUserAdd <= @ActorId=2348, @GroupId=1, @UserId=2349
                                     |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                     |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                     |  |  | Message:    ck:sGroupUserAdd-{28}-[Security.ActorMustBeSytem]
                                     |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                     |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                     |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                     |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                     |  |  └─────────────────────────────────────────────────────────────────────────
                                     |  └─────────────────────────────────────────────────────────────────────────
                                     └─────────────────────────────────────────────────────────────────────────
                    +17.7766032 E exec CK.sGroupRemoveAllUsers <= @ActorId=2348, @GroupId=1
                                     ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                     | Message:    exec CK.sGroupRemoveAllUsers <= @ActorId=2348, @GroupId=1
                                     |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                     |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                     |  |  | Message:    ck:sGroupUserRemove-{25}-[Security.ActorMustBeSytem]<-CK.sGroupRemoveAllUsers
                                     |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                     |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                     |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                     |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                     |  |  └─────────────────────────────────────────────────────────────────────────
                                     |  └─────────────────────────────────────────────────────────────────────────
                                     └─────────────────────────────────────────────────────────────────────────
                    +17.8095942 i Done.
1B~~~~                            ~~ Monitor: cdf18c88-5249-4894-8b28-0f45ac7b886e
                    +17.8545862 i Done.
1C~~~~                            ~~ Monitor: 060aa844-a453-43b3-8201-fe1e7091efd1
                    +17.8728882 E exec CK.sUserCreate <= @ActorId=0, @UserName=N'09fbddfd-a0c2-482a-b175-238f53204003', @UserIdResult=null output
                                     ┌──────────────────────────■ Exception: SqlDetailedException ■──────────────────────────
                                     | Message:    exec CK.sUserCreate <= @ActorId=0, @UserName=N'09fbddfd-a0c2-482a-b175-238f53204003', @UserIdResult=null output
                                     |  ┌──────────────────────────■ [Inner Exception] ■──────────────────────────
                                     |  |  ┌──────────────────────────■ Exception: SqlException ■──────────────────────────
                                     |  |  | Message:    Security.AnonymousNotAllowed
                                     |  |  | Stack:         at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
                                     |  |  |                at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
                                     |  |  |                at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
                                     |  |  |                at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                                     |  |  |                at CK.SqlServer.SqlConnectionControllerExtension.<>c.<ExecuteNonQuery>b__2_0(SqlCommand c)
                                     |  |  |                at CK.SqlServer.SqlStandardCallContext.CK.SqlServer.ISqlCommandExecutor.ExecuteQuery[T](IActivityMonitor monitor, SqlConnection connection, SqlCommand cmd, Func`2 innerExecutor)
                                     |  |  └─────────────────────────────────────────────────────────────────────────
                                     |  └─────────────────────────────────────────────────────────────────────────
                                     └─────────────────────────────────────────────────────────────────────────
                    +17.9014926 i Done.
1D~~~~                            ~~ Monitor: 81fafa6e-cebc-430d-9c34-c14822dfe782
                    +17.9609627 i Done.
1E~~~~                            ~~ Monitor: 9bc1bf7f-3b9f-47e3-9bfa-524b14a9d447
                    +18.0224881 i Done.
1F~~~~                            ~~ Monitor: 9aa9c120-e3ee-478f-8b5e-91e184520abc
                    +18.1606628 i Done.
