create transformer on CK.sUserGoogleCreateOrUpdate
as
begin
	add parameter @EMail nvarchar(255) = N'', @EMailVerified bit = 0;

	inject "
	declare @PrevEMail nvarchar(255);
	declare @PrevEMailVerified bit;" after single statement {declare @PrevRefreshToken};

	inject "
	if @EMail is null set @EMail = N'';
	if @EMailVerified is null set @EMailVerified = 0;
	" after single statement {if @RefreshToken is null};

	in single statement {select	@ActualUserId = UserId}
	begin
		inject ", @PrevEMail = EMail, @PrevEMailVerified = EMailVerified " before single {from CK.tUserGoogle};
	end

	in single statement {insert into CK.tUserGoogle}
	begin
		add column EMail = @EMail, EMailVerified = @EMailVerified;
	end

end